<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="ansible-role-crypto"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title><literal>crypto_policies</literal> </title>
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    <abstract>
      <para>
     This role is designed to manage the system-wide cryptographic policy framework on Linux systems.</para>
    </abstract>
  </info>
  <para>Provides a consistent and declarative way to configure system-wide crypto policies.
    The default is <literal>null</literal>,which means the role will not make any changes to the system's cryptographic policy.
    </para>
    <section xml:id="crypto-role-variables">
      <title> <literal>crypto_policies</literal> role variables</title>
      <para>Some important variables include:
      </para>
    <itemizedlist>
      <listitem>
        <para>
<literal>crypto_policies_policy</literal>: This is the primary variable for setting the desired policy.
You can set it to one of the predefined policies like <literal>DEFAULT</literal>, <literal>FUTURE</literal>
<literal>LEGACY</literal> or <literal>FIPS</literal>. You can also specify a base policy with sub-policies for example, <literal>DEFAULT:NO-SHA1:GOST</literal>.
The list of available base policies on the target system is located in the <literal>crypto_policies_available_policies</literal> variable
and the list of available sub-policies can be found in the <literal>crypto_policies_available_subpolicies</literal> variable.
</para>
      </listitem>
      <listitem>
        <para>
     <literal>crypto_policies_reload</literal>: This variable attempts to automatically reload affected services and daemons after changing the system-wide cryptographic policy.
     By default, set to <literal>true</literal>, which forces a reload of daemons like <literal>sshd</literal> sshd and <literal>httpd</literal> to immediately apply the new policy.
     Setting it to <literal>false</literal> prevents these reloads, which is useful when you want to handle service restarts manually or during a system's initial setup.
    </para>
      </listitem>
      <listitem>
        <para>
          <literal>crypto_policies_reboot_ok</literal>: This variable is a boolean that controls whether the
          role is permitted to trigger a system reboot. By default, the value is  <literal>false</literal>.
          This means that if a reboot is required to fully apply the cryptographic policy changes, the role will not automatically perform it.
          </para>
      </listitem>
      <listitem>
        <para>
          <literal>crypto_policies_transactional_update_reboot_ok</literal>: This variable is a boolean that manages reboots triggered by transactional updates.
          If a transactional update necessitates a reboot, setting this variable to <literal>true</literal> allows the role to proceed with the reboot automatically.
          If set to <literal>false</literal>, the role notifies the user that a reboot is required, enabling custom handling.
           If this variable is not defined, the role will fail, ensuring the reboot requirement is not overlooked.
        </para>
      </listitem>
        </itemizedlist>
       <example><title>A <literal>crypto_policies</literal> playbook example</title>
        <para>This example configures the system to the default crypto policy level without SHA1.
          The update is done without reboot, it is recommended to do afterwards.
        </para>
<screen>
- name: Manage crypto policies
  hosts: all
  roles:
    - role: linux-system-roles.crypto_policies
  vars:
    crypto_policies_policy: "DEFAULT:NO-SHA1"
    crypto_policies_reload: false
</screen>
        </example>
       </section>
    </topic>