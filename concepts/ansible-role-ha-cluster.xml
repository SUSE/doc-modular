<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="ansible-role-ha-cluster"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>hacluster</title>
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    <abstract>
      <para>
      This role automates the complex process of setting up and maintaining a cluster that ensures continuous availability of services by eliminating single points of failure..
        </para>
    </abstract>
  </info>
  <section xml:id="hacluster-role-variables">
  <title> hacluster role variables</title>
  <para>Variables are parameters used to automate the full configuration of a High Availability cluster, dictating settings such as the cluster name, node addresses for Corosync communication,
    fencing device definitions and the various cluster resources to be managed by Pacemaker.
  Some variables include:</para>

<itemizedlist>
  <listitem>
    <para>
<literal>ha_cluster_export_configuration</literal>: is a boolean variable when set to <literal>true</literal>, instructs the role to read and export the existing Pacemaker or Corosync cluster configuration
into Ansible facts for later use. The default is <literal>false</literal>.
</para>
  </listitem>
  <listitem>
    <para>
 <literal>ha_cluster_enable_repos_resilient_storage</literal>: is a boolean variable when set to <literal>true</literal>, enables the Resilient Storage repository on the target managed nodes
 The default value is <literal>false</literal>. </para>
  </listitem>
  <listitem>
    <para>
 <literal>ha_cluster_enable_repos</literal>: is a boolean variable when set to <literal>true</literal>, enables the required High Availability repositories on the target managed nodes.
 The default value is <literal>true</literal>. </para>
  </listitem>
  <listitem>
    <para>
 <literal>ha_cluster_manage_firewall</literal>: is a boolean variable when set to <literal>true</literal>, automatically configure the firewall on the target managed nodes.
 The default value is <literal>false</literal>. </para>
  </listitem>
  <listitem>
    <para>
 <literal>ha_cluster_manage_selinux</literal>: is a boolean variable when set to <literal>true</literal>, directs the <literal>ha_clster</literal> to automatically configure the necessary SELinux policy on the cluster nodes.
 It ensures that the ports associated with the high-availability services, such as, Corosync or Pacemaker, are correctly labeled with the appropriate <literal>cluster_port_t</literal> &selnx; port type, allowing cluster components to communicate securely.
 The default value is <literal>false</literal>. </para>
  </listitem>
    </itemizedlist>
   <example><title>A hacluster playbook example </title>
    <para> This playbook:</para>
    <itemizedlist>
     <listitem>
      <para>Sets up a two-node Pacemaker cluster using the <literal>ha_cluster</literal> role.</para>
     </listitem>
     <listitem>
      <para>Defines a cluster with a unique name.</para>
     </listitem>
     <listitem>
      <para>Adds the two specified nodes to the cluster.</para>
     </listitem>
     <listitem>
      <para>Configure the cluster to manage fencing and resource promotion.</para>
     </listitem>
    </itemizedlist>
  <screen>
  - name: Configure a two-node Pacemaker cluster
    hosts: node1, node2
    become: true
    gather_facts: false

    vars:
      ha_cluster_cluster_name: my-cluster
      ha_cluster_nodes:
        - name: node1
          ha_cluster_node_id: 1
        - name: node2
          ha_cluster_node_id: 2
      ha_cluster_manage_fencing: true
      ha_cluster_resource_defaults:
        - parameter: resource-stickiness
          value: 1
        - parameter: migration-threshold
          value: 1

    roles:
      - name: linux-system-roles.ha_cluster  </screen>
</example>
</section>
</topic>
