<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="ansible-role-journald"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>About the journald Linux system role</title>
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    <abstract>
      <para>
       The journald Linux system role in Ansible is designed to configure and manage the <literal>systemd-journald</literal> service on &productname; 16.0 systems.
      </para>
    </abstract>
  </info>
  <para>The role automates changes to <filename>/etc/systemd/journald.conf</filename>file. You can use this role to:</para>
  <itemizedlist>
  <listitem><para>Determine where journal logs are stored. Logs can be stored temporarily in memory or persistently on the disk.</para></listitem>
  <listitem><para>Set hard limits on how much disk space the journal can consume before old logs are deleted.</para></listitem>
  <listitem><para>Configure how much disk space the journal should always leave free for other system uses.</para></listitem>
  <listitem><para>Control whether journal data objects should be compressed to save space.</para></listitem>
  <listitem><para>Configure whether log data is kept separate for individual users.</para></listitem>
  <listitem><para>Manage the running state of the <literal>systemd-journald</literal>service.</para></listitem>
    </itemizedlist>
<example><title>Configure persistent storage, limit disk usage, enable user logging and set synchronization frequency</title>
<screen>
  ---
  - name: Configure persistent storage, limit disk usage, enable user logging and set synchronization frequency
    hosts: all

    vars:
         journald_persistent: true
         journald_max_disk_size: 1024
         journald_per_user: true
         journald_sync_interval: 1

    roles:
      - role: linux-system-roles.journald
</screen>
<itemizedlist>
  <listitem><para><literal>journald_persistent: true</literal>: instructs journald to create the <filename> /var/log/journal</filename> directory and store logs permanently.
   <literal>journald_persistent</literal> is a <literal>Boolean</literal> datatype and accepts values accepts values <literal>true</literal> and<literal>false</literal>.
 Default is <literal>false</literal>.</para></listitem>
  <listitem><para><literal>journald_max_disk_size: 1024</literal>: limits the total disk space the journal files may use up to 1 Gigabyte (1024 MB).
   <literal>journald_max_disk_size</literal> is an <literal>integer</literal> datatype and accepts an integer representing a size in megabytes (MB).
   No value is explicitly configured by this role; therefore, the default sizing logic from <literal>man 5 journald.conf</literal> applies.
 </para></listitem>
 <listitem><para><literal>journald_per_user: true</literal>: Enables per-user logging. Logs are kept separate for individual users, allowing unprivileged users to read logs related only to their own services.
  <literal>journald_per_user</literal> is a <literal>Boolean</literal> datatype and accepts values <literal>true</literal>,<literal>false</literal>,<literal>yes</literal>,<literal>no</literal>, <literal>0</literal> and <literal>1</literal>.
  Default is <literal>false</literal>.
</para></listitem>
<listitem><para><literal>journald_sync_interval: 1</literal>: limits the total disk space the journal files may use up to 1 Gigabyte (1024 MB).
  <literal>journald_max_disk_size</literal> is an <literal>integer</literal> datatype and accepts an integer representing a time span in minutes.
  By default role does not alter currently used value.
</para></listitem>
 </itemizedlist>
</example>
<example><title>Configure <literal>systemd-journald</literal> for persistent storage and disk limits</title>
<screen>
  ---
     - name: Configure systemd-journald for persistent storage and disk limits
       hosts: all
       become: true

       vars:
         journald_persistent: true
         journald_max_disk_size: 1024

       roles:
         - role: linux-system-roles.journald
</screen>
  <itemizedlist>
   <listitem><para><literal>journald_persistent: true</literal>: instructs journald to create the <filename> /var/log/journal</filename> directory and store logs permanently.
    <literal>service</literal> is a <literal>Boolean</literal> datatype and accepts values accepts values <literal>true</literal>,<literal>false</literal>,<literal>yes</literal>,<literal>no</literal>, <literal>0</literal> and <literal>1</literal>.
  Default is <literal>false</literal>.</para></listitem>
   <listitem><para><literal>journald_max_disk_size: 1024</literal>: limits the total disk space the journal files may use up to 1 Gigabyte (1024 MB).
    <literal>journald_max_disk_size</literal> is an <literal>integer</literal> datatype and accepts an integer representing a size in megabytes (MB).
    No value is explicitly configured by this role; therefore, the default sizing logic from <literal>man 5 journald.conf</literal> applies.
  </para></listitem>
  </itemizedlist>
  </example>
<para>For more details about all the variables in the journald Linux system role,
  refer to the specific <literal>REDADME.md</literal> file on the control node:</para>
  <screen>/usr/share/ansible/collections/ansible_collections/suse/linux_system_roles/docs</screen>
</topic>