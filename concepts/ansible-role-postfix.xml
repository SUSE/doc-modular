<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="ansible-role-postfix"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>About the Postfix Linux system role</title>
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    <abstract>
      <para>
       The Postfix Linux system role in Ansible is designed to install, configure, and manage the Postfix Mail Transfer Agent (MTA) on &productname; 16.0 systems.
      </para>
    </abstract>
  </info>
  <para>You can use this role to:</para>
  <itemizedlist>
  <listitem><para>Ensure the Postfix package is installed and any conflicting MTAs like Sendmail are removed.</para></listitem>
  <listitem><para>Configure the server to forward all outgoing mail to a secure a relay host, for example an internal corporate mail server.</para></listitem>
  <listitem><para>Set key parameters like <literal>myhostname</literal>, <literal>mydomain</literal>and <literal>myorigin</literal> to define the server's identity, configure inet interfaces for security
    and establish TLS and SASL authentication for secure relay host communication.</para></listitem>
  <listitem><para>Manage the system-wide mail aliases file <filename>/etc/aliases</filename>. This enables you to redirect mail sent to local users to external email addresses.</para></listitem>
  <listitem><para>Ensure the Postfix service is enabled and running.</para></listitem>
  </itemizedlist>
<example><title>Install and enable postfix</title>
<screen>
---
- name: install and enable postfix
  hosts: all

  vars:
    postfix_conf:
      relay_domains: $mydestination
      relayhost: example.com
  roles:
    - linux-system-roles.postfix</screen>
<itemizedlist>
 <listitem><para><literal>postfix_conf</literal>: is a dictionary variable that serves as the primary interface for directly configuring parameters in the Postfix mail server's main configuration file i.e. <filename>/etc/postfix/main.cf</filename>.
  The default is empty<literal>{}</literal>.</para></listitem>
  <listitem><para><literal>relay_domains</literal>: is a configuration parameter that defines the set of destination domains for which the Postfix server is configured to act as an intermediate mail relay rather than performing final local delivery or sending mail directly to the
    final recipient's server on the internet. In this example, Postfix is configured to relay mail for its own local domains <literal>$mydestination</literal>.
  </para></listitem>
  <listitem><para><literal>relayhost</literal>: is a configuration parameter that defines the next-hop destination for all outgoing email that Postfix cannot deliver locally.
In this example, the single external SMTP server is <literal>example.com</literal>.
  </para></listitem>
</itemizedlist>
</example>
<example><title>Do not run a postfix check</title>
<screen>
---
- name: Manage postfix with no check
  hosts: all

  vars:
    postfix_check: false
  roles:
    - linux-system-roles.postfix
</screen>
  <itemizedlist>
   <listitem><para><literal>postfix_check: false</literal>: controls whether a configuration validation check is performed before restarting the Postfix service.
    <literal>postfix_check</literal> is a <literal>Boolean</literal> datatype and accepts values <literal>true</literal> and <literal>false</literal>.
  Default is <literal>true</literal>.
  </para></listitem>
     </itemizedlist>
  </example>
<para>For more details about all the variables in the <literal>postfix</literal> Linux system role,
  refer to the specific <literal>REDADME.md</literal> file on the control node:</para>
  <screen>/usr/share/ansible/collections/ansible_collections/suse/linux_system_roles/docs</screen>
</topic>