<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="ansible-role-selinux"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>About the &selnx; Linux system role</title>
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    <abstract>
      <para>
       The &selnx; Linux system role in Ansible automates the full management and enforcement of the &selnx; policy on managed nodes in a standardized and idempotent way.
      </para>
    </abstract>
  </info>
  <para>You can use this role to:</para>
  <itemizedlist>
  <listitem><para>Set the global &selnx; mode to <literal>enforcing</literal>, <literal>permissive</literal> or <literal>disabled</literal> using the <literal>selinux_state</literal> variable.</para></listitem>
  <listitem><para>Manage the state of &selnx; booleans.</para></listitem>
  <listitem><para>Define persistent rules for file system labeling (file contexts) for custom directories or applications.</para></listitem>
  <listitem><para>Define security types for non-standard network ports, allowing services to listen on them without violating the policy.</para></listitem>
  <listitem><para>Manage the mapping between Linux user accounts and specific &selnx; user identities.</para></listitem>
  </itemizedlist>
<example><title>Reset the &selnx; context on all nodes</title>
<screen>
---
- name: Reset the selinux context
  hosts: all

  vars:
  selinux_restore_dirs:
    - /var/www/
    - /etc/

  roles:
    - linux-system-roles.selinux</screen>
<itemizedlist>
 <listitem><para><literal>selinux_restore_dirs</literal>: specifies file system paths on the managed node where the &selnx; contexts should be immediately reapplied or corrected (using the equivalent of the <literal>restorecon</literal> utility).
  It is a list of strings, where each string is a file system tree where you want to run <literal>restorecon</literal>.</para></listitem>
</itemizedlist>
</example>
<example><title>Set a &selnx; network port label</title>
<screen>
---
- name: set a selinux port label
  hosts: all

  vars:
    selinux_ports:
      - ports: 8080
        proto: tcp
        setype: http_port_t
        state: present

  roles:
    - linux-system-roles.postfix
</screen>
  <itemizedlist>
   <listitem><para><literal>selinux_ports</literal>: manages the &selnx; port labeling policy on a managed node.
  It is a list of dictionaries  with each dictionary defining a specific port rule. <literal>ports</literal> are strings or a list
  and define port numbers to which you want to assign the &selnx; label. Multiple values separated by a comma are accepted.
 <literal>proto</literal> is a <literal>string</literal> datatype and defines the network protocol. <literal>setype</literal> is a <literal>string</literal> datatype and defines the &selnx; type (label) to assign to the port.
</para></listitem>
     </itemizedlist>
  </example>
<para>For more details about all the variables in the &selnx; Linux system role,
  refer to the specific <literal>REDADME.md</literal> file on the control node:</para>
  <screen>/usr/share/ansible/collections/ansible_collections/suse/linux_system_roles/docs</screen>
</topic>