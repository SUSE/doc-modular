<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="ansible-role-suseconnect"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>About the &suseconnect; Linux system role</title>
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    <abstract>
      <para>
       The &suseconnect; Linux system role in Ansible manages SUSE Linux system registrations with &scc; or a &smt; server. It automates the process of
       registering and deregistering systems, as well as managing additional products and modules on a SUSE system.
      </para>
    </abstract>
  </info>
  <para>You can use this role to:</para>
  <itemizedlist>
  <listitem><para>Register a SUSE system to the SCC or  servers.</para></listitem>
  <listitem><para>Activate or remove of specific add-on products or modules.</para></listitem>
  <listitem><para>Deregister systems or products.</para></listitem>
  <listitem><para>Support transactional update register SLE-MICRO.</para></listitem>
  <listitem><para>Recheck tasks to ensure a smooth registration process.</para></listitem>
  <listitem><para>Ensure compatibility with public cloud environments.</para></listitem>
  </itemizedlist>
<example><title>Register a &productname; 16.0 system</title>
<screen>
---
- name: Register with SCC and activate modules
  hosts: all
  vars:
    suseconnect_base_product:
      key: '{{ sles_registration_key }}'
      product: '{{ ansible_distribution }}'

    suseconnect_subscriptions:
      - {name: "sle-module-containers", state: enabled}
      - {name: "PackageHub", state: disabled}
      - {name: "sle-module-python3", state: enabled}

  tasks:
    - name: Register system and modules with SUSE Customer Center
      ansible.builtin.include_role:
        name: suseconnect
</screen>
<itemizedlist>
 <listitem><para><literal>suseconnect_base_product</literal>: defines the required parameters for registering the core operating system of a SUSE Linux machine.
  <literal>suseconnect_base_product</literal> is defined as a YAML Dictionary containing key-value pairs that map directly to the requirements of SCC or SMT servers.
  Accepted string values are <literal>key</literal>, <literal>product</literal>, <literal>version</literal> and <literal>arch</literal>. </para></listitem>
  <listitem><para><literal>suseconnect_subscriptions</literal>: is a crucial component for enterprise SUSE deployments, as it controls which features for example, High Availability, containers, or web application platforms
     enabled on the registered base operating system.
    <literal>suseconnect_subscriptions</literal> is defined as a YAML Dictionary containing key-value pairs that map directly to the requirements of SCC or SMT servers.
    Accepted string values are <literal>name</literal>, <literal>state</literal>, <literal>version</literal> and <literal>key</literal>. </para></listitem>

</itemizedlist>
</example>
<example><title>Deregister base products</title>
<screen>
---
- name: Deregister products from SCC
  hosts: all
  vars:
    suseconnect_deregister: true

  tasks:
    - name: Deregister products from SUSE Customer Center
      ansible.builtin.include_role:
        name: suseconnect
</screen>
  <itemizedlist>
    <listitem><para><literal>suseconnect_deregister: true</literal>: instructs the system to deactivate its base subscription and remove it from the the SCC or SMT servers.
     <literal>suseconnect_deregister</literal> is a <literal>Boolean</literal> datatype variable and accepts values <literal>false</literal> and <literal>true</literal>. When set to
     <literal>true</literal>, it executes the necessary SUSEConnect command to deregister the system's base product subscription. Default is <literal>false</literal>. </para></listitem>
      </itemizedlist>
  </example>
<para>For more details about all the variables in the &suseconnect; Linux system role,
  refer to the specific <literal>REDADME.md</literal> file on the control node:</para>
  <screen>/usr/share/ansible/collections/ansible_collections/suse/linux_system_roles/docs</screen>
</topic>