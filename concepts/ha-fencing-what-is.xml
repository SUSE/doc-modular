<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>

<!-- refers to legacy doc: https://github.com/SUSE/doc-sleha/blob/main/xml/ha_fencing.xml -->

<topic xml:id="ha-fencing-what-is"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>What is &stonith;?</title>
    <meta name="maintainer" content="tahlia.richardson@suse.com" its:translate="no"/>
    <abstract>
      <xi:include href="../snippets/ha-fencing.xml"/>
      <xi:include href="../snippets/ha-stonith.xml"/>
    </abstract>
  </info>
  <section xml:id="ha-fencing-what-is-components">
    <title>Components</title>
    <variablelist>
      <varlistentry>
        <term>pacemaker-fenced</term>
        <listitem>
          <para>
            The <systemitem>pacemaker-fenced</systemitem> daemon runs on every node in the &ha;
            cluster. It accepts fencing requests from <systemitem>pacemaker-controld</systemitem>.
            It can also check the status of the fencing device.
        </para>
      </listitem>
      </varlistentry>
      <varlistentry>
        <term>&stonith; resource agent</term>
        <listitem>
          <para>
            The interface between the cluster and the fencing device. Every supported fencing device
            can be controlled by a specific &stonith; resource agent.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>&stonith; device</term>
        <listitem>
          <para>
            The device that resets or powers off a node when requested by the cluster. The
            &stonith; device you use depends on your budget and hardware.
          </para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section xml:id="ha-fencing-what-is-device-types">
    <title>&stonith; devices</title>
    <variablelist>
      <varlistentry>
        <term>Physical devices</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <para>
                <emphasis>Power Distribution Units (PDU)</emphasis> are devices with multiple power
                outlets that can provide remote load monitoring and power recycling.
              </para>
            </listitem>
            <listitem>
              <para>
                <emphasis>Uninterruptible Power Supplies (UPS)</emphasis> provide emergency power to
                connected equipment in the event of a power failure.
              </para>
            </listitem>
            <listitem>
              <para>
                <emphasis>Blade power control devices</emphasis> can be used for fencing if the
                cluster nodes are running on a set of blades. This device must be capable of
                managing single-blade computers.
              </para>
            </listitem>
            <listitem>
              <para>
                <emphasis>Lights-out devices</emphasis> are network-connected devices that allow
                remote management and monitoring of servers.
              </para>
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Software mechanisms</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <para>
                <emphasis>Disk-based &sbd;</emphasis> fences nodes by exchanging messages via shared
                block storage. It works together with a watchdog on each node to ensure that
                misbehaving nodes are really stopped.
              </para>
            </listitem>
            <listitem>
              <para>
                <emphasis>Diskless &sbd;</emphasis> fences nodes by using only the watchdog, without
                a shared storage device. Unlike other &stonith; mechanisms, diskless &sbd; does not
                need a &stonith; resource agent.
              </para>
            </listitem>
            <listitem>
              <para>
                <emphasis>fence_kdump</emphasis> checks if a node is performing a kernel dump.
                If so, the cluster acts as if the node was fenced. This avoids fencing a node that
                is already down but doing a dump. This resource agent must be used together with a
                physical &stonith; device. It cannot be used with &sbd;.
              </para>
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
    </variablelist>

  </section>
  <section xml:id="ha-fencing-what-is-more-info">
    <title>For more information</title>
    <para>
      For more information, see
      <link xlink:href="https://clusterlabs.org/projects/pacemaker/doc/3.0/Pacemaker_Explained/html/fencing.html"/>.
    </para>
    <para>
      For a full list of supported &stonith; devices, run the
      <command>crm ra list stonith</command> command.
    </para>
    <para>
      For details about a specific &stonith; device, run the
      <command>crm ra info stonith:<replaceable>DEVICE</replaceable></command> command.
    </para>
  </section>
</topic>
