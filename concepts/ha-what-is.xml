<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>

<!-- refers to legacy doc: https://github.com/SUSE/doc-sleha/blob/main/xml/ha_concepts.xml -->

<topic xml:id="ha-what-is"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>What is &sleha;?</title>
    <meta name="maintainer" content="tahlia.richardson@suse.com" its:translate="no"/>
    <abstract>
      <para>
       Introductory text
      </para>
    </abstract>
  </info>

  <section xml:id="ha-what-is-availability">
    <title>Product availability</title>
    <para>
      &sleha; is available with the following products:
    </para>
    <variablelist>
      <varlistentry>
        <term>&sles;</term>
        <listitem>
          <para>
            &ha; is available as an extension. This extension requires an additional registration code.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>&s4s;</term>
        <listitem>
          <para>
            &ha; is included as a module. No additional registration code is required.
          </para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>

  <section xml:id="ha-what-is-capabilities-benefits">
    <title>Capabilities and benefits</title>
    <para>
      A paragraph of text, answering the question above and explaining the
      mechanism behind foo bar.
    </para>
  </section>

  <section xml:id="ha-what-is-example-cluster-scenario">
    <title>Example cluster scenario</title>
    <para>
      Suppose you have configured a three-node cluster, with a Web server installed on each of the three nodes in the cluster. Each of the nodes in the cluster hosts two Web sites. All the data, graphics, and Web page content for each Web site are stored on a shared disk subsystem connected to each of the nodes in the cluster. The following figure depicts how this setup might look.
    </para>
    <figure xml:id="fig-ha-example-three-node-cluster">
      <title>Three-node cluster</title>
      <mediaobject>
        <imageobject role="fo">
          <imagedata fileref="ha-example-three-node-cluster.svg" width="100%"/>
        </imageobject>
        <imageobject role="html">
          <imagedata fileref="ha-example-three-node-cluster.svg" width="80%"/>
        </imageobject>
        <textobject role="description">
          <phrase>
            This diagram shows three cluster nodes: Web server 1, Web server 2, and Web server 3.
            Each Web server has two Web sites on it. Each Web server is also connected to a
            Fibre Channel switch, which is then connected to shared storage.
          </phrase>
        </textobject>
      </mediaobject>
    </figure>
    <para>
      During normal cluster operation, each node is in constant communication with the other nodes in the cluster and performs periodic polling of all registered resources to detect failure.
    </para>
    <para>
      Suppose Web Server 1 experiences hardware or software problems and the users depending on Web Server 1 for Internet access, e-mail, and information lose their connections. The following figure shows how resources are moved when Web Server 1 fails.
    </para>
    <figure xml:id="fig-ha-example-three-node-cluster-node1-fail">
      <title>Three-node cluster after one node fails</title>
      <mediaobject>
        <imageobject role="fo">
          <imagedata fileref="ha-example-three-node-cluster-node1-fail.svg" width="100%"/>
        </imageobject>
        <imageobject role="html">
          <imagedata fileref="ha-example-three-node-cluster-node1-fail.svg" width="80%"/>
        </imageobject>
        <textobject role="description">
          <phrase>
            This diagram shows three cluster nodes: Web server 1, Web server 2, and Web server 3.
            Web server 1 is crossed out. Web server 2 and Web server 3 each have three Web sites.
            Web site A and Web site B are highlighted in orange to show that they migrated from
            the crossed-out Web server 1.
          </phrase>
        </textobject>
      </mediaobject>
    </figure>
    <para>
      Web Site A moves to Web Server 2 and Web Site B moves to Web Server 3. IP addresses and certificates also move to Web Server 2 and Web Server 3.
    </para>
    <para>
      When you configured the cluster, you decided where the Web sites hosted on each Web server would go should a failure occur. In the previous example, you configured Web Site A to move to Web Server 2 and Web Site B to move to Web Server 3. This way, the workload formerly handled by Web Server 1 continues to be available and is evenly distributed between any surviving cluster members.
    </para>
    <para>
      When Web Server 1 failed, the &ha; software did the following:
    </para>
    <itemizedlist>
      <listitem>
        <para>
          Detected a failure and verified with &stonith; that Web Server 1 was really dead. &stonith; is an acronym for <quote>Shoot The Other Node In The Head</quote>. It is a means of bringing down misbehaving nodes to prevent them from causing trouble in the cluster.
          </para>
      </listitem>
      <listitem>
        <para>
          Remounted the shared data directories that were formerly mounted on Web server 1 on Web Server 2 and Web Server 3.
        </para>
      </listitem>
      <listitem>
        <para>
          Restarted applications that were running on Web Server 1 on Web Server 2 and Web Server 3.
        </para>
      </listitem>
      <listitem>
        <para>
          Transferred IP addresses to Web Server 2 and Web Server 3.
        </para>
      </listitem>
    </itemizedlist>
    <para>
      In this example, the failover process happened quickly and users regained access to Web site information within seconds, usually without needing to log in again.
    </para>
    <para>
      Now suppose the problems with Web Server 1 are resolved, and Web Server 1 is returned to a normal operating state. Web Site A and Web Site B can either automatically fail back (move back) to Web Server 1, or they can stay where they are. This depends on how you configured the resources for them. Migrating the services back to Web Server 1 will incur some down-time. Therefore &productname; also allows you to defer the migration until a period when it will cause little or no service interruption. There are advantages and disadvantages to both alternatives.
    </para>
    <para>
      &productname; also provides resource migration capabilities. You can move applications, Web sites, etc. to other servers in your cluster as required for system management.
    </para>
    <para>
      For example, you could have manually moved Web Site A or Web Site B from Web Server 1 to either of the other servers in the cluster. Use cases for this are upgrading or performing scheduled maintenance on Web Server 1, or increasing performance or accessibility of the Web sites.
    </para>
  </section>
</topic>
