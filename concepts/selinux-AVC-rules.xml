<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="selinux-avc-rules"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Access vector rules</title>
    <meta name="maintainer" content="jsindelarova@suse.com" its:translate="no"/>
    <abstract><!-- can be changed via merge in the assembly -->
      <para>
       The topic focuses on access vector rules that specify access permissions for object classes.
      </para>
    </abstract>
  </info>
      <para>
      A access vector rule (AVC rule) is a rule that defines access control for object classes. The permissions for an object class are represented by a bit mask called an access vector, hence the term acces vector rule.
    </para>
    
    <para>
      The generic rule syntax is as follows:
    </para>
    <screen><replaceable>RULE_NAME</replaceable> <replaceable>SOURCE_TYPE</replaceable> <replaceable>TARGET_TYPE</replaceable> : <replaceable>OBJECT_CLASS</replaceable> <replaceable>PERMISSIONS</replaceable>;</screen>
    <para>
      Where the terms have the following meanings:
    </para>
    <variablelist>
      <varlistentry>
        <term>RULE_NAME</term>
        <listitem>
          <para>
            A AVC rule name that can have one of the following values:
          </para>
          <itemizedlist>
      <listitem>
        <para>
          <literal>allow</literal> - specifies whether the access from the source type to the target type is allowed. 
        </para>
      </listitem>
      <listitem>
        <para>
          <literal>dontaudit</literal> - stops auditing of the denial messages. The rule can be used if the denial is expected and does not cause real issues to the system.
        </para>
      </listitem>
      <listitem>
        <para>
          <literal>auditallow</literal> - audit this tule in the log. Keep in mind that there must be the same <literal>allow</literal> rule to grant the access.
        </para>
      </listitem>
      <listitem>
        <para>
          <literal>neverallow</literal> - specifies that no <literal>allow</literal> can be generated for the operation, even if it was allowed before.
        </para>
      </listitem>
    </itemizedlist>
            </listitem>
      </varlistentry>
      <varlistentry>
        <term>SOURCE_TYPE</term>
        <listitem>
          <para>
            The type granted access, a domain type of a process that is attempting an access.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>TARGET_TYPE</term>
        <listitem>
          <para>
            The type of an object to which the source is being granted access. The type can be replaced with the <literal>self</literal> statement to specify acces to the same type as the SOURCE_TYPE.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>OBJECT_CLASS</term>
        <listitem>
          <para>
            The class of object that the specified access is permitted for, for example, <literal>file</literal>.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>PERMISSIONS</term>
        <listitem>
          <para>
            A list of access permission that the source is allowed to the target type, for example, <literal>execute</literal>. The permissions is a space separated list of operations enclosed in {}. To include all permissions available for that type, use the <literal>*</literal> operator.
          </para>
        </listitem>
      </varlistentry>
    </variablelist>
    <para>
      The following example of AVC rule allows <literal>uset_t</literal> to execute files of the <literal>bin_t</literal> type.
    </para>
    <screen>allow user_t bin_t : file execute;</screen>

    <section xml:id="selinux-avc-rules-attributes">
      <title>Attributes</title>
      <para>
        Attributes provide a way to refence multiple types in an AVC rule. You need to define the attributes in the policy as follows:
      </para>
      <para>
        For example, if you defined an attribute <literal>exec_files_t</literal> that allows to execute all files for a common user (<literal>user_t</literal>
      </para>
    </section>
  
</topic>
