<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="selinux-rules"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>&selnx; Access Rules</title>
    <!-- can be changed via merge in the assembly -->
    <!--add author's email address-->
    <meta name="maintainer" content="amrita.sakthivel@suse.com" its:translate="no"/>
    </info>
  <para>
    &selnx; rules define whether a subject's security context (source) is permitted or denied access to an object's security context (target), explicitly specifying the allowed or denied permissions and the class of the object being accessed.
  </para>
  <para>&selnx; rules generally follow this format:</para>
  <screen>rule_name source target:class permissions;</screen>
 <variablelist>
      <varlistentry>
        <term>rule_name</term>
        <listitem>
          <para>
             An access vector rule (AVC rule) is a rule that defines access control for object classes. The permissions for an object class are represented by a bitmask called an access vector, hence the term <literal>access vector rule</literal>. </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>source</term>
        <listitem>
          <para> The &selnx; context of the process (subject)</para>
        </listitem>
      </varlistentry>
 <varlistentry>
        <term>target</term>
        <listitem>
          <para>The &selnx; context of the resource (object) </para>
        </listitem>
      </varlistentry>
<varlistentry>
        <term>class</term>
        <listitem>
          <para>Type of object such as a file,process or socket</para>
        </listitem>
      </varlistentry>
<varlistentry>
        <term>permissions</term>
        <listitem>
          <para>Allowed actions such as read, write and execute</para>
        </listitem>
      </varlistentry>
      </variablelist>
  <tip>
    <title>Listing SELinux rules</title>
    <para>
      The <command>setools-console</command> package contains <command>sesearch</command>,
      which is a convenient tool to list all rules.
    </para>
    <para>
      For example, to check if the loaded policy has a rule that allows passwd (process running with <literal>passwd_t</literal> type) write access to the <filename>/etc/shadow</filename> file (labelled as <literal>shadow_t</literal>), you can use this command:
<screen>
&prompt.root; sesearch -A -s passwd_t -t shadow_t -p write
allow passwd_t shadow_t:file { append create getattr ioctl link lock map open read relabelfrom relabelto rename setattr unlink watch watch_reads write };
</screen>
      This output shows that there is a rule, so the access is allowed.
    </para>
  </tip>
</topic>
