<?xml version="1.0"?>
<article xmlns="http://docbook.org/ns/docbook" version="5.2" xml:id="transactional-updates" xml:lang="ja">
  <info>
    <title xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its"><command>transactional-update</command>を使用した<phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>の管理</title>
    <revhistory xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" xml:id="rh-transactional-updates">
      <revision>
        <date>2024-11-19</date>
        <revdescription>
          <para>
            Initial version
           </para>
        </revdescription>
      </revision>
    </revhistory>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="maintainer" content="jsindelarova@suse.com" its:translate="no"/>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="architecture" its:translate="no">
      <phrase>AMD64/Intel&#xA0;64</phrase>
      <phrase>POWER</phrase>
      <phrase>IBM</phrase>
      <phrase>AArch64</phrase>
    </meta>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="productname" its:translate="no">
      <productname version="6.1">SUSE Linux Micro</productname>
    </meta>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="description" its:translate="yes"><command>transactional-update</command>コマンドを使用した<phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>の管理。</meta>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="title" its:translate="yes"><command>transactional-update</command>コマンドの使用法とそのユースケース。</meta>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="social-descr" its:translate="yes"><command>transactional-update</command>コマンドを使用した<phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>の管理。</meta>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="task" its:translate="no">
      <phrase>Upgrade &amp; Update</phrase>
      <phrase>Administration</phrase>
    </meta>
    <meta xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its" name="series" its:translate="no">Products &amp; Solutions</meta>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">
      <dm:bugtracker>
        <dm:url>https://bugzilla.suse.com/enter_bug.cgi</dm:url>
        <dm:component>Documentation</dm:component>
        <dm:product>SUSE Linux Micro 6.1</dm:product>
        <dm:assignee>jsindelarova@suse.com</dm:assignee>
      </dm:bugtracker>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
    <abstract xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">
      <variablelist>
        <varlistentry>
          <term>概要</term>
          <listitem>
            <para>
                <command>transactional-update</command>コマンドを使用すると、読み込み専用ファイルシステムを変更できます。変更は別個のスナップショットで実行され、そのスナップショットでブートするまで実行中のシステムには影響しません。
              </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>目的</term>
          <listitem>
            <para>
                <phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>とその更新を管理し、更新の失敗によるシステムのダウンタイムのリスクを最小限に抑えながら、簡単にロールバックできるようにする必要があります。
              </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>所要時間</term>
          <listitem>
            <para>
                <command>transactional-update</command>コマンドの理解に30分ほどを要します。
              </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>目標</term>
          <listitem>
            <para>
                <command>transactional-update</command>の仕組みと、これを使用してシステムを管理する方法を理解します。
              </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>要件</term>
          <listitem>
            <itemizedlist>
              <listitem>
                <para>
                    <phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>の実行中のインスタンス。
                  </para>
              </listitem>
              <listitem>
                <para><systemitem class="username">root</systemitem>特権。
                  </para>
              </listitem>
            </itemizedlist>
          </listitem>
        </varlistentry>
      </variablelist>
    </abstract>
  </info>
  <section xml:lang="ja" role="concept" version="5.1" xml:id="concept-transactional-update">
    <info>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" name="maintainer" content="tbazant@suse.com" its:translate="no"/>
      <title xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink">トランザクション更新</title>
    </info>
    <section xml:id="what-is-transactional-update">
      <title>トランザクション更新とは</title>
      <para>
      ベースオペレーティングシステムの安定性と一貫性を維持するため、<phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>では、読み込み専用ルートファイルシステムを使用しています。したがって、たとえば<command>zypper</command>コマンドを使用しても、ルートファイルシステムを直接変更することはできません。<phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>では、ルートファイルシステムに1つ以上の変更を適用可能な<emphasis>トランザクション更新</emphasis>が代わりに導入されています。
    </para>
      <para>
      <command>transactional-update</command>のデフォルトの動作では、変更のたびに現在のルートファイルシステムから新しいスナップショットが作成されます。この変更を適用するにはホストの再起動が必要です。再起動することなく<command>transactional-update</command>コマンドを複数回実行して、スナップショットにさらに変更を加えることはできません。このような操作を行うと、以前のスナップショットの変更を含まない独立した別個のスナップショットが作成されます。
    </para>
    </section>
    <section xml:id="how-transactional-update-works">
      <title>トランザクション更新の動作</title>
      <para>
      パッケージのインストール、何らかの更新、パッチの適用といったシステムの変更操作で<command>transactional-update</command>コマンドを呼び出すたびに、次のアクションが実行されます。
    </para>
      <procedure>
        <title>ルートファイルシステムの変更</title>
        <step>
          <para>
          現在のルートファイルシステムまたは指定したスナップショットから、新しい読み書きスナップショットが作成されます。
        </para>
        </step>
        <step>
          <para>
          すべての変更が適用されます(更新、パッチ、パッケージのインストール)。
        </para>
        </step>
        <step>
          <para>
          このスナップショットが読み込み専用モードに切り替わります。
        </para>
        </step>
        <step>
          <para>
          変更が正常に適用されると、新しいルートファイルシステムのスナップショットがデフォルトとして設定されます。
        </para>
        </step>
        <step>
          <para>
          再起動すると、新しいスナップショットでシステムがブートします。
        </para>
        </step>
      </procedure>
    </section>
    <section xml:id="benefits-transactional-update">
      <title>トランザクション更新の利点</title>
      <itemizedlist>
        <listitem>
          <para>
          アトミックであることから、更新は正常に完了した場合にのみ適用されます。
        </para>
        </listitem>
        <listitem>
          <para>
          現在とは別のスナップショットに変更が適用されるので、実行中のシステムは影響を受けません。
        </para>
        </listitem>
        <listitem>
          <para>
          変更を容易にロールバックできます。
        </para>
        </listitem>
      </itemizedlist>
    </section>
    <section xml:id="tr-up-environment">
      <title><command>transactional-update</command>コマンド内の環境</title>
      <para>
      <command>transactional-update</command>コマンドを実行するたびに、新しいスナップショットが変更されます。スナップショットの環境は、<command>transactional-update</command>コマンドを実行したシェルの環境と異なることがあります。たとえば、現在の作業ディレクトリ(<literal>$PWD</literal>)が、<command>transactional-update</command>を実行するディレクトリではなく、<literal>/</literal>に設定されていることがあります。
    </para>
      <para>
      スナップショットから<filename>/var</filename>ディレクトリにアクセスすることはできません。このディレクトリはスナップショットにも含まれません。ただし、スナップショットからは除外されていても、<command>transactional-update</command>環境でアクセスできるディレクトリもあります(<filename>/root</filename>ディレクトリなど)。
    </para>
    </section>
  </section>
  <section xml:lang="ja" role="reference" version="5.1" xml:id="reference-transactional-update-usage">
    <info>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" name="maintainer" content="tbazant@suse.com" its:translate="no"/>
      <title xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink"><command>transactional-update</command>コマンドの使用</title>
      <abstract xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink">
        <para>
        <command>transactional-update</command>コマンドでは、更新のアトミックなインストールまたは削除が可能です。すべてが正常にインストールされている場合にのみ更新が適用されます。<command>transactional-update</command>によってシステムのスナップショットが作成され、これを使用してシステムが更新されます。このスナップショットは後で復元できます。再起動後にのみ、すべての変更がアクティブになります。
      </para>
      </abstract>
    </info>
    <para>
    <command>transactional-update</command>コマンドの構文は次のとおりです。
  </para>
    <screen>
transactional-update <option>[option]</option> <replaceable>[general_command]</replaceable> <replaceable>[package_command]</replaceable> <replaceable>standalone_command</replaceable>
</screen>
    <note>
      <title>引数を指定しない<command>transactional-update</command>の実行</title>
      <para>
      <command>transactional-update</command>コマンドの実行でどのコマンドもオプションも指定しないと、システム自体が更新されます。
    </para>
    </note>
    <para>
    使用できるコマンドパラメータについて、次で詳しく説明します。
  </para>
    <variablelist>
      <title><command>transactional-update</command>オプション</title>
      <varlistentry>
        <term>
          <option>--interactive, -i</option>
        </term>
        <listitem>
          <para>
          パッケージのコマンドで指定すると、対話モードをオンにすることができます。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--non-interactive, -n</option>
        </term>
        <listitem>
          <para>
          パッケージのコマンドで指定すると、非対話モードをオンにすることができます。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry xml:id="transactional-update-continue">
        <term>
          <option>--continue [<replaceable>number</replaceable>], -c</option>
        </term>
        <listitem>
          <para>
          <option>--continue</option>オプションでは、再起動せずにルートファイルシステムに複数の変更を適用できます。詳細については、<xref linkend="transactional-update-no-reboot" role="internalbook"/>を参照してください。
        </para>
          <para>
          <option>--continue</option>オプションには、既存のスナップショットを新しいスナップショットのベースとして選択できる便利な機能もあります。次の例では、<command>transactional-update</command>を実行して、スナップショット13に基づいてスナップショットに新しいパッケージをインストールしてから、このコマンドをもう一度実行して別のパッケージをインストールする方法を示しています。
        </para>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update pkg install <replaceable>package_1</replaceable></command>
          </screen>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update --continue 13 pkg install <replaceable>package_2</replaceable></command>
          </screen>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--no-selfupdate</option>
        </term>
        <listitem>
          <para>
          <command>transactional-update</command>の自己更新を無効にします。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--drop-if-no-change, -d</option>
        </term>
        <listitem>
          <para>
          ルートファイルシステムに変更がなかった場合、<command>transactional-update</command>で作成されたスナップショットを破棄します。<filename>/etc</filename>ディレクトリに変更があった場合、その変更を現在のファイルシステムにマージします。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--quiet</option>
        </term>
        <listitem>
          <para>
          <literal>stdout</literal>に<command>transactional-update</command>コマンドを出力しません。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--help, -h</option>
        </term>
        <listitem>
          <para>
          <command>transactional-update</command>コマンドのヘルプを出力します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--version</option>
        </term>
        <listitem>
          <para>
          <command>transactional-update</command>コマンドのバージョンを表示します。
        </para>
        </listitem>
      </varlistentry>
    </variablelist>
    <section xml:id="transactional-update-general">
      <title>一般コマンド</title>
      <para>
      このセクションでは、<command>transactional-update</command>の汎用のコマンドを一覧にします。
    </para>
      <variablelist>
        <varlistentry>
          <term>
            <command>grub.cfg</command>
          </term>
          <listitem>
            <para>
            GRUBブートローダ設定ファイルの再構築に使用します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>bootloader</command>
          </term>
          <listitem>
            <para>
            ブートローダを再インストールします。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>initrd</command>
          </term>
          <listitem>
            <para>
            <literal>initrd</literal>の再構築に使用します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>kdump</command>
          </term>
          <listitem>
            <para>
            ハードウェアやストレージを変更する場合に、Kdump initrdの再構築が必要になることがあります。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>reboot</command>
          </term>
          <listitem>
            <para>
<command>reboot</command>の動作は、システムに対して実行された設定と変更によって異なります。<command>soft-reboot</command>が有効な場合、ハードウェアとカーネルを再起動せずにユーザスペースのみを再起動できます。<command>soft-reboot</command>の有効化と設定については、<xref linkend="transactional-update-soft-reboot" role="internalbook"/>で説明します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>run <replaceable>&lt;command&gt;</replaceable></command>
          </term>
          <listitem>
            <para>
            指定されたコマンドを新しいスナップショットで実行します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>shell</command>
          </term>
          <listitem>
            <para>
            終了する前に新しいスナップショットで読み書きシェルを開きます。通常、このコマンドはデバッグの目的で使用します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>setup-fips</command>
          </term>
          <listitem>
            <para>
            このコマンドは、システムでFIPSを有効にするために必要なすべての変更を実行します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>
            <command>setup-selinux</command>
          </term>
          <listitem>
            <para>
            対象のSELinuxポリシーをインストールして有効にします。
          </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>
    <section role="reference" xml:lang="ja" version="5.2" xml:id="transactional-update-soft-reboot">
      <info>
        <abstract xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">
          <para/>
        </abstract>
        <title xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion"><command>soft-reboot</command>の設定</title>
        <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="jsindelarova@suse.com" its:translate="no"/>
      </info>
      <section xml:id="transactional-update-soft-reboot-enabling">
        <title><command>soft-reboot</command>の有効化/無効化</title>
        <para>
      <command>transactional-update</command>で<command>soft-reboot</command>を有効にするには、次の手順に従います。
    </para>
        <procedure>
          <step>
            <para>
          ディレクトリ<filename>/etc/tukit.conf.d/</filename>を作成します。
        </para>
            <screen><prompt>&gt; </prompt><command>sudo</command> mkdir /etc/tukit.conf.d/</screen>
          </step>
          <step>
            <para>
          次の内容が含まれるファイル<filename>/etc/tukit.conf.d/soft-reboot.conf</filename>を作成します。
        </para>
            <screen>REBOOT_ALLOW_SOFT_REBOOT=true</screen>
            <para>
たとえば、次のコマンドを実行します。
        </para>
            <screen><prompt>&gt; </prompt><command>sudo</command> echo "REBOOT_ALLOW_SOFT_REBOOT=true" &gt; /etc/tukit.conf.d/soft-reboot.conf</screen>
          </step>
        </procedure>
        <para>
      <command>soft-reboot</command>を無効にするには、<filename>/etc/tukit.conf.d/soft-reboot.conf</filename>ファイルで<literal>true</literal>を<literal>false</literal>に変更します。
    </para>
      </section>
      <section xml:id="transactional-update-soft-reboot-packages">
        <title><command>soft-reboot</command>の設定</title>
        <para>
  <filename>/usr/etc/zypp/zypp-boot-plugin.conf</filename>ファイルで、特定のタイプの再起動が必要なパッケージを定義できます。変更するには、このファイルを<filename>/etc/zypp/zypp-boot-plugin.conf</filename>にコピーします。このファイルは書き込み可能であり、更新時に置き換えられません。<filename>/etc/zypp/zypp-boot-plugin.conf</filename>ファイルは<filename>/usr/etc/zypp/zypp-boot-plugin.conf</filename>よりも優先順位が高いため、ユーザが指定した設定がデフォルトの設定よりも優先されます。
</para>
        <para>
  <filename>/etc/zypp/zypp-boot-plugin.conf</filename>ファイルの<literal>[main]</literal>セクションには、次の3つの再起動オプションがあります。
</para>
        <variablelist>
          <varlistentry>
            <term>reboot</term>
            <listitem>
              <para>
ここでは、変更時にハードウェアの再起動が必要なパッケージを指定します。
      </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>kexec</term>
            <listitem>
              <para>
        変更時にカーネルの再起動が必要なパッケージのリストを提供します。ただし、ハードウェアの再起動は行われず、GRUB2はトリガされません。
      </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>soft-reboot</term>
            <listitem>
              <para>
      変更時にユーザスペースの再起動のみが必要なパッケージを指定します。
    </para>
            </listitem>
          </varlistentry>
        </variablelist>
        <para>
エントリには、パッケージ名のコンマ区切りリスト、または特定のアプリケーションまたはシステムコンポーネントを提供するすべてのパッケージのリストを指定できます。正規表現も使用できます。以下に例を示します。
</para>
        <screen>
soft-reboot = glibc, dbus-broker
</screen>
        <para>
または、<literal>provides</literal>ステートメントを使用します。
</para>
        <screen>
soft-reboot = provides: dbus
</screen>
      </section>
    </section>
  </section>
  <section role="task" xml:lang="ja" version="5.2" xml:id="transactional-update-no-reboot">
    <info>
      <title xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">再起動せずに複数の変更を適用する方法</title>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="tbazant@suse.com" its:translate="no"/>
      <abstract xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">
        <para>
        <command>transactional-update</command>コマンドは、トランザクションシステムのルートファイルシステムに変更を適用します。デフォルトの動作では、変更のたびに現在のルートファイルシステムから新しいスナップショットが作成され、再起動して変更が適用されます。
      </para>
      </abstract>
    </info>
    <para>
    再起動せずにルートファイルシステムに複数の変更を適用するには、次の各セクションで説明するいくつかのオプションがあります。
  </para>
    <section xml:id="transactional-update-continue-option">
      <title><command>transactional-update</command> <option>--continue</option>オプション</title>
      <para>
      再起動せずに複数の変更を適用するには、<option>--continue</option>オプションを指定した<command>transactional-update</command>コマンドを使用します。このコマンドを実行するたびに、それまでのスナップショットに対するすべての変更と新しい変更を収めた別のスナップショットが作成されます。最後のスナップショットにはすべての変更が記録されています。これらの変更を適用するにはシステムを再起動します。これにより、最後のスナップショットが新しいルートファイルシステムになります。
    </para>
    </section>
    <section xml:id="transactional-update-run">
      <title><command>transactional-update run</command>コマンド</title>
      <para>
      通常、<command>transactional-update</command> <command>run</command>コマンドでは単一のコマンドのみが実行されます。ただし、<command>bash</command>などのコマンドシェルで複数のコマンドを連結すれば、このコマンドを使用して、単一のトランザクションセッションでそれら複数のコマンドを実行できます。次に例を示します。
    </para>
      <screen>
        <prompt>&gt; </prompt>
        <command>sudo</command>
        <command>transactional-update run bash -c 'ls &amp;&amp; date; if [ true ]; then echo -n "Hello "; echo '\''world'\''; fi'</command>
      </screen>
      <note>
        <para>
        <command>transactional-update run</command>コマンドには、<xref linkend="transactional-update-shell" role="internalbook"/>での説明にある<command>transactional-update shell</command>コマンドと同じ制限があります。入力したコマンドが<filename>/var/log/transactional-update.log</filename>ファイルに記録される点のみが異なります。
      </para>
      </note>
    </section>
    <section xml:id="transactional-update-shell">
      <title><command>transactional-update</command>シェル</title>
      <para>
      <command>transactional-update shell</command>コマンドは、transactional-update環境でシェルを開きます。このシェルでは、ファイルシステムを変更するLinuxコマンドのほとんどすべてを入力できます。たとえば、<command>zypper</command>コマンドによる複数のパッケージのインストールや、読み込み専用ファイルシステムに属するファイルの変更などができます。また、それまでに<command>transactional-update</command>コマンドで指定した変更が正しいことも確認できます。
    </para>
      <important>
        <para>
        このトランザクションシェルにはいくつかの制限があります。たとえば、<systemitem class="daemon">systemd</systemitem>コマンドによるサービスの開始操作と停止操作や、マウントされていない<filename>/var</filename>パーティションの変更などはできません。また、シェルセッションで入力したコマンドは<filename>/transactional-update.log</filename>ファイルに記録されません。
      </para>
      </important>
      <para>
      ファイルシステムに対するすべての変更は、単一のスナップショットに収められます。ファイルシステムの変更が完了し、<command>exit</command>コマンドを使用してシェルを終了したら、変更を適用するためにホストを再起動する必要があります。
    </para>
    </section>
  </section>
  <section role="task" xml:lang="ja" version="5.2" xml:id="tr-up-cleanup">
    <info>
      <title xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">スナップショットのクリーンアップの実行</title>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="jsindelarova@suse.com" its:translate="no"/>
      <abstract xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">
        <para>
        <command>transactional-update</command>を使用して、未使用のファイルシステムスナップショットや、参照されていない<filename>/etc</filename>オーバーレイディレクトリをクリーンアップできます。
      </para>
      </abstract>
    </info>
    <para><command>transactional-update</command>は、次のクリーンアップコマンドを認識します。
  </para>
    <variablelist>
      <varlistentry>
        <term>
          <command>cleanup-snapshots</command>
        </term>
        <listitem>
          <para>
          このコマンドは、すべての未使用スナップショットにSnapperの削除対象としてマークを付けます。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>cleanup-overlays</command>
        </term>
        <listitem>
          <para>
          このコマンドは、<filename>/var/lib/overlay</filename>ディレクトリ内にある<filename>/etc</filename>のすべての未使用オーバーレイレイヤを削除します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>cleanup</command>
        </term>
        <listitem>
          <para>
          このコマンドは、<command>cleanup-snapshots</command>コマンドと<command>cleanup-overlays</command>コマンドを組み合わせたものです。
        </para>
        </listitem>
      </varlistentry>
    </variablelist>
    <section xml:id="tr-up-cleanup-how-it-works">
      <title>クリーンアップの仕組み</title>
      <para>
      <command>transactional-update cleanup</command>コマンドを実行すると、クリーンアップアルゴリズムを持たない、すべての古いスナップショットにクリーンアップアルゴリズムが設定されます。すべての重要なスナップショットにもマークが付けられます。このコマンドを使用すると、<filename>/var/lib/overlay</filename>内の参照されていない(したがって未使用の)すべての<filename>/etc</filename>オーバーレイディレクトリも削除されます。
    </para>
      <para>
      <literal>number</literal>クリーンアップアルゴリズムが設定されたスナップショットは、<filename>/etc/snapper/configs/root</filename>で次のパラメータによって設定されているルールに従って削除されます。
    </para>
      <variablelist>
        <varlistentry>
          <term>NUMBER_MIN_AGE</term>
          <listitem>
            <para>
            自動的に削除できるスナップショットの最小保持期間(秒単位)を定義します。
          </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>NUMBER_LIMIT/NUMBER_LIMIT_IMPORTANT</term>
          <listitem>
            <para>
            保存するスナップショットの最大数を定義します。指定した最大値を超えるスナップショットは、クリーンアップアルゴリズムによって削除されます。スナップショットとファイルシステムの領域は考慮されません。また、最小値を超えるスナップショットも、スナップショットとファイルシステムの制限に達するまで削除されます。
          </para>
          </listitem>
        </varlistentry>
      </variablelist>
      <para>
      スナップショットのクリーンアップは、<systemitem class="daemon">systemd</systemitem>によっても定期的に実行されます。
    </para>
    </section>
  </section>
  <section role="reference" xml:lang="ja" version="5.2" xml:id="transactional-update-registering-product">
    <info>
      <title xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">製品の登録</title>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="tbazant@suse.com" its:translate="no"/>
      <abstract xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">
        <para>
        <command>transactional-update register</command>コマンドを使用して、製品の登録とそのサブスクリプションの管理に関するすべてのタスクを処理できます。以下のオプションを指定できます。
      </para>
      </abstract>
    </info>
    <variablelist>
      <varlistentry>
        <term>
          <option>--list-extensions</option>
        </term>
        <listitem>
          <para>
          システムで利用可能な拡張機能を一覧表示します。この出力を使用して、製品のアクティベーションで使用する製品識別子を探し出すことができます。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>-p, --product</option>
        </term>
        <listitem>
          <para>
          アクティベーションの対象とする製品を指定できます。製品識別子の形式は<emphasis>&lt;name&gt;/&lt;version&gt;/&lt;architecture&gt;</emphasis>です。たとえば、<literal>sle-module-live-patching/15.3/x86_64</literal>と指定します。対応するコマンドの形式は次のとおりです。
        </para>
          <screen><prompt>&gt; </prompt><command>sudo</command> transactional-update register -p sle-module-live-patching/15.3/x86_64</screen>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>-r, --regcode</option>
        </term>
        <listitem>
          <para>
          指定された登録コードでシステムを登録します。サブスクリプションを登録し、ソフトウェアのリポジトリを有効にします。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>-d, --de-register</option>
        </term>
        <listitem>
          <para>
          システムの登録を解除します。<literal>-p</literal>オプションが指定されている場合は拡張機能の登録を解除します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>-e, --email</option>
        </term>
        <listitem>
          <para>
          SUSE Customer Centerで登録に使用する電子メールアドレスを指定します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--url</option>
        </term>
        <listitem>
          <para>
          登録サーバのURLを指定します。このURLは設定に保存され、以降のコマンドの呼び出しで使用されます。次に例を示します。
        </para>
          <screen><prompt>&gt; </prompt><command>sudo</command> transactional-update register --url https://scc.suse.com</screen>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>-s, --status</option>
        </term>
        <listitem>
          <para>
          現在の登録ステータスをJSON形式で表示します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--write-config</option>
        </term>
        <listitem>
          <para>
          指定されたオプション値を<filename>/etc/SUSEConnect</filename>設定ファイルに書き込みます。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--cleanup</option>
        </term>
        <listitem>
          <para>
          古いシステム資格情報を削除します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--version</option>
        </term>
        <listitem>
          <para>
          バージョンを出力します。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <option>--help</option>
        </term>
        <listitem>
          <para>
          コマンドの使用方法を表示します。
        </para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section role="reference" xml:lang="ja" version="5.2" xml:id="transactional-update-managing-software">
    <info>
      <title xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">ソフトウェアパッケージの管理</title>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="tbazant@suse.com" its:translate="no"/>
      <abstract xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">
        <para>
        <command>transactional-update</command>を使用して、ソフトウェアパッケージをインストール、更新、または削除できます。
      </para>
      </abstract>
    </info>
    <para><phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>では、製品の登録後に利用可能なリポジトリからソフトウェアパッケージを取得します。メインリポジトリを除き、<phrase><phrase os="slmicro">SUSE Linux Micro</phrase></phrase>は追加のリポジトリにアクセスすることができます。この追加のリポジトリには、顧客の便宜のために提供される、主にテストおよび開発目的のサポート対象外パッケージが集められています。
  </para>
    <para><command>transactional-update</command>では、次のコマンドを使用してソフトウェアパッケージを管理します。
  </para>
    <tip>
      <title><command>pkg</command>コマンドとZypperのオプション</title>
      <para>
      <command>transactional-update pkg</command>コマンドでは、使用するサブコマンドに対応するZypperのオプションを使用できます。たとえば、<command>transactional-update pkg install</command>は、<command>zypper install</command>が理解するすべてのオプションを理解します。
    </para>
    </tip>
    <variablelist>
      <varlistentry>
        <term>
          <command>pkg install</command>
        </term>
        <listitem>
          <para>
          <command>zypper install</command>コマンドを使用して、使用可能なチャネルから個々のパッケージをインストールします。このコマンドは、Program Temporary Fix (PTF) RPMファイルをインストールするために使用することもできます。このコマンドのデフォルトオプションは<option>--interactive</option>です。
        </para>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update pkg install <replaceable>package_name</replaceable></command>
          </screen>
          <para>
          または
        </para>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update pkg install <replaceable>rpm1 rpm2</replaceable></command>
          </screen>
          <para>
          ソフトウェアパターンをインストールするには次のように指定します。
        </para>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update pkg install -t pattern <replaceable>pattern_name</replaceable></command>
          </screen>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>pkg remove</command>
        </term>
        <listitem>
          <para>
          <command>zypper remove</command>コマンドを使用してアクティブなスナップショットから個々のパッケージを削除します。このコマンドは、PTF RPMファイルを削除するために使用することもできます。このコマンドのデフォルトオプションは<option>--interactive</option>です。
        </para>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update pkg remove <replaceable>package_name</replaceable></command>
          </screen>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>pkg update</command>
        </term>
        <listitem>
          <para>
          <command>zypper update</command>コマンドを使用してアクティブなスナップショットから個々のパッケージを更新します。ベースファイルシステムのスナップショットの一部であるパッケージのみを更新できます。このコマンドのデフォルトオプションは<option>--interactive</option>です。
        </para>
          <screen>
            <prompt>&gt; </prompt>
            <command>sudo</command>
            <command>transactional-update pkg update <replaceable>package_name</replaceable></command>
          </screen>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>patch</command>
        </term>
        <listitem>
          <para>
          利用可能なパッチを確認してインストールします。このコマンドのデフォルトオプションは<option>--non-interactive</option>です。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>dup</command>
        </term>
        <listitem>
          <para>
          システムをアップグレードします。このコマンドのデフォルトオプションは<option>--non-interactive</option>です。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>up</command>
        </term>
        <listitem>
          <para>
          インストールされているパッケージをより新しいバージョンに更新します。このコマンドのデフォルトオプションは<option>--non-interactive</option>です。
        </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <command>migration</command>
        </term>
        <listitem>
          <para>
          選択したターゲットにシステムを移行します。通常、SUSE Customer Centerからシステムを登録している場合に、システムのアップグレードに使用します。
        </para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section role="task" xml:lang="ja" version="5.2" xml:id="tr-up-rollback">
    <info>
      <title xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">システムのロールバックの実行</title>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="jsindelarova@suse.com" its:translate="no"/>
      <abstract xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">
        <para>
      GRUB 2ではbtrfsスナップショットからブートできます。そのため、新しいスナップショットが正しく機能しない場合、機能する古いスナップショットを使用できます。
    </para>
      </abstract>
    </info>
    <para>
      スナップショットをブートする場合、スナップショットに含まれているファイルシステムの該当部分が読み込み専用でマウントされます。スナップショットから除外されている他のすべてのファイルシステムと該当部分は読み書き可能でマウントされ、変更できます。
    </para>
    <tip>
      <title>特定のインストール状態へのロールバック</title>
      <para>
        システムの初期インストールの終了時に、ブート可能な初期スナップショットが作成されます。このスナップショットをブートすることで、いつでもその状態に戻ることができます。スナップショットは、<literal>first root file system</literal>という記述で識別できます。
      </para>
    </tip>
    <para>
      システムロールバックを実行するには2つの方法があります。
    </para>
    <itemizedlist>
      <listitem>
        <para>
          実行中のシステムからデフォルトのスナップショットを設定できます。詳細については、<xref linkend="proc-running-snapshot" role="internalbook"/>を参照してください。
        </para>
      </listitem>
      <listitem>
        <para>
          特に現在のスナップショットが壊れている場合は、新しいスナップショットでブートして、それをデフォルトに設定できます。詳細については、<xref linkend="proc-boot-snapshot" role="internalbook"/>を参照してください。
        </para>
      </listitem>
    </itemizedlist>
    <para>
      現在のスナップショットが機能している場合は、次のシステムロールバック手順を使用できます。
    </para>
    <procedure xml:id="proc-running-snapshot">
      <title>実行中のシステムからのロールバック</title>
      <step>
        <para>
          デフォルトとして設定するスナップショットを特定し、その番号をメモします。
        </para>
        <screen><prompt>&gt; </prompt><command>sudo</command> snapper list</screen>
      </step>
      <step>
        <para>
          そのスナップショットをデフォルトとして設定します。
        </para>
        <screen><prompt>&gt; </prompt><command>sudo</command> transactional-update rollback <replaceable>snapshot_number</replaceable></screen>
        <para>
          <replaceable>snapshot number</replaceable>を省略すると、現在のスナップショットがデフォルトとして設定されます。
        </para>
        <tip>
          <title>機能する最後のスナップショットの設定</title>
          <para>
            機能する最後のスナップショットをデフォルトとして設定するには、<command>rollback last</command>を実行します。
          </para>
        </tip>
      </step>
      <step>
        <para>
          システムを再起動して、新しいデフォルトのスナップショットでブートします。
        </para>
      </step>
    </procedure>
    <para>
      次の手順は、現在のスナップショットが壊れていて、そのスナップショットでブートできない場合に使用します。
    </para>
    <procedure xml:id="proc-boot-snapshot">
      <title>機能するスナップショットへのロールバック</title>
      <step>
        <para>
          システムを再起動し、［<literal>Start bootloader from a
          read-only snapshot</literal>］を選択します。
        </para>
      </step>
      <step>
        <para>
          ブートするスナップショットを選択します。スナップショットは作成日に従ってソートされ、最新のスナップショットが一番上に表示されます。
        </para>
      </step>
      <step>
        <para>
          システムにログインし、すべてが期待どおりに機能しているかどうかを確認します。スナップショットから除外されたディレクトリに書き込まれたデータはそのまま残ります。
        </para>
      </step>
      <step>
        <para>
          ブートしたスナップショットがロールバックに適さない場合は、システムを再起動して別のスナップショットを選択します。
        </para>
        <para>
          スナップショットが期待どおりに機能する場合は、次のコマンドを実行して、ロールバックを実行できます。
        </para>
        <screen>
          <prompt>&gt; </prompt>
          <command>sudo</command>
          <command>transactional-update rollback</command>
        </screen>
        <para>
          その後、再起動します。
        </para>
      </step>
    </procedure>
  </section>
  <section role="task" xml:lang="ja" version="5.2" xml:id="tr-up-automatic-updates">
    <info>
      <abstract xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" xmlns:its="http://www.w3.org/2005/11/its">
        <para/>
      </abstract>
      <title xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion">自動トランザクション更新の管理</title>
      <meta xmlns:its="http://www.w3.org/2005/11/its" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:trans="http://docbook.org/ns/transclusion" name="maintainer" content="jsindelarova@suse.com" its:translate="no"/>
    </info>
    <para>
    自動更新は、1日1回実行される<command>systemd.timer</command>によって制御されます。これは、すべての更新に適用され、マシンが再起動する必要があることを<command>rebootmgrd</command>に知らせます。更新が実行される時刻を調整できます。systemd.timer(5)のマニュアルを参照してください。
  </para>
    <section xml:id="tr-up-automatic-updates-disable">
      <title>自動更新の無効化</title>
      <para>
      デフォルトでは、自動更新が有効化されています。ただし、次のコマンドで無効化できます。
    </para>
      <screen>
        <prompt>&gt; </prompt>
        <command>sudo</command>
        <command>systemctl --now disable transactional-update.timer</command>
      </screen>
    </section>
    <section xml:id="tr-up-automatic-updates-configuring-notifications">
      <title>失敗した更新の通知の設定</title>
      <para>
      自動の<command>transactional-update</command>が失敗した場合、失敗したスナップショットは削除されます。その間にシステムが再起動されるため、最後の自動更新が失敗したことを確認できません。したがって、自動の<command>transactional-update</command>の失敗を通知する<systemitem class="daemon">systemd</systemitem>サービスを設定できます。この設定手順は、次の手順にまとめることができます。
    </para>
      <itemizedlist>
        <listitem>
          <para>
          必要なパッケージがシステムに存在しない場合はインストールする。詳細については、<xref linkend="tr-up-automatic-updates-configuring-notifications-packages" role="internalbook"/>を参照してください。
        </para>
        </listitem>
        <listitem>
          <para>
          <literal>systemd-status-mail</literal>サービスを設定する。詳細については、<xref linkend="tr-up-automatic-updates-configuring-notifications-service" role="internalbook"/>を参照してください。
        </para>
        </listitem>
      </itemizedlist>
      <section xml:id="tr-up-automatic-updates-configuring-notifications-packages">
        <title>必要なパッケージのインストール</title>
        <para>
        通知を設定するには、パッケージ<literal>mailx</literal>と<literal>systemd-status-mail</literal>が必要です。これらのパッケージはデフォルトでシステムに存在します。ただし、これらのパッケージをインストールしていない場合は、次のコマンドを実行してインストールします。
      </para>
        <screen><prompt>&gt; </prompt><command>sudo</command> transactional-update pkg in systemd-status-mail mailx</screen>
        <para>
        システムを再起動します。
      </para>
      </section>
      <section xml:id="tr-up-automatic-updates-configuring-notifications-service">
        <title><literal>systemd-status-mail</literal>サービスの設定</title>
        <para>
        <literal>systemd-status-mail</literal>サービスを設定するには、設定ファイルを作成するか、<literal>jeos-config</literal>ツールを使用できます。
      </para>
        <section xml:id="tr-up-automatic-updates-configuring-notifications-jeos">
          <title><literal>jeos-config</literal>を使用したサービスの設定</title>
          <para>
          電子メール通知を設定するには、次に説明するように<literal>jeos-config</literal>ツールを使用できます。
        </para>
          <procedure>
            <step>
              <para>
              設定ウィンドウを開くには、次のコマンドを実行します。
            </para>
              <screen><prompt>&gt; </prompt><command>sudo</command> jeos-config status_mail
      </screen>
            </step>
            <step>
              <para>
              ダイアログで、必要に応じて項目を設定します。
            </para>
            </step>
            <step>
              <para>
              <guimenu>OK</guimenu>をクリックして、確定します。
            </para>
            </step>
          </procedure>
        </section>
        <section xml:id="tr-up-automatic-updates-configuring-notifications-file">
          <title>設定ファイルの編集によるサービスの設定</title>
          <para>
          デフォルトの設定ファイルは、<filename>/usr/etc/default/systemd-status-mail</filename>にあります。これを変更するには、<filename>/etc/default/</filename>にコピーを作成して次の項目を編集します。
        </para>
          <variablelist>
            <varlistentry>
              <term>ADDRESS</term>
              <listitem>
                <para>
                必須エントリ。通知の送信先の電子メールアドレスを指定します。次に例を示します。
              </para>
                <screen>
ADDRESS=&#x201C;tux@example.com&#x201D;
      </screen>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>FROM</term>
              <listitem>
                <para>
                通知メールの送信者の電子メールアドレス。アドレスが有効であることを確認します。次に例を示します。
              </para>
                <screen>
FROM=&#x201C;geeko@example.com&#x201D;
      </screen>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>MAILER</term>
              <listitem>
                <para>
                通知を送信するメールアプリケーションのタイプ。次のように、<literal>mailx</literal>の値を使用します。
              </para>
                <screen>
MAILER=&#x201C;mailx&#x201D;
      </screen>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>RELAYHOST</term>
              <listitem>
                <para>
                mailxで使用するメールリレーを指定します。
              </para>
                <screen>
RELAYHOST=&#x201C;mail.example.com:587&#x201D;
      </screen>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>MAILX_OPTIONS</term>
              <listitem>
                <para>
                必要なオプションを指定し、メールプロバイダが通知メールを確実に受け入れるようにします。
              </para>
                <screen>
MAILX_OPTIONS="-Sverbose -Ssmtp-use-starttls -Ssmtp-auth=login -Ssmtp-auth-user='tux@example.com' -Ssmtp-auth-password='TopSecret'"
      </screen>
              </listitem>
            </varlistentry>
          </variablelist>
        </section>
      </section>
    </section>
  </section>
  <section version="5.2" xml:id="legal-disclaimer">
    <info>
      <title xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink">法的事項</title>
    </info>
    <para>Copyright © 2006–<?dbtimestamp format="Y"?>
 SUSE LLC and contributors. All rights reserved. </para>
    <para>
    この文書は、GNUフリー文書ライセンスのバージョン1.2または(オプションとして)バージョン1.3の条項に従って、複製、頒布、および/または改変が許可されています。ただし、この著作権表示およびライセンスは変更せずに記載すること。ライセンスバージョン1.2のコピーは、<quote>GNUフリー文書ライセンス</quote>セクションに含まれています。
  </para>
    <para>
    SUSEの商標については、<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.suse.com/company/legal/"/>を参照してください。その他の第三者のすべての商標は、各社の所有に帰属します。商標記号(®、™など)は、SUSEおよび関連会社の商標を示します。アスタリスク(*)は、第三者の商標を示します。
  </para>
    <para>
    本書のすべての情報は、細心の注意を払って編集されています。しかし、このことは正確性を完全に保証するものではありません。SUSE LLC、その関係者、著者、翻訳者のいずれも誤りまたはその結果に対して一切責任を負いかねます。
  </para>
  </section>
  <appendix xmlns:its="http://www.w3.org/2005/11/its" version="5.2" role="legal" its:translate="no" xml:id="doc-gfdl-license">
    <info>
      <title xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink">GNUフリー文書利用許諾契約書(GFDL)</title>
    </info>
    <para>
  Copyright (C) 2000, 2001, 2002 Free Software Foundation, Inc. 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.この使用許諾書を一字一句そのままの複製および頒布することは許可されますが、変更は許可されません。
 </para>
    <bridgehead renderas="sect4">
    0. 序文
  </bridgehead>
    <para>
  この利用許諾契約書の目的は、マニュアル、テキストブック、またはその他の機能的で有用な文書を、自由という意味で「フリー」にすることです。つまり、そのような文書を、変更の有無や商用非商用に関わらず、コピーまたは再配布する実効的な自由をすべての人々に保証することです。第二に、本利用許諾契約書は、作者または発行者が他者によって行われた変更について責任を負わないとともに、その著作物の功績が確保されるように意図されています。
 </para>
    <para>
  本利用許諾契約書は、「コピーレフト」(著作物を自由に複製および改変できるようにすること)の一種であり、文書の派生著作物は、それ自体が同じ意味においてフリーでなければなりません。フリーソフトウェア向けに考慮されたコピーレフト利用許諾であるGNU一般公衆利用許諾契約書(GPL)を補足するものです。
 </para>
    <para>
  弊社は、この利用許諾契約書をフリーソフトウェアのマニュアルに使用するために設計しました。それは、フリーソフトウェアにはフリーマニュアルが必要であるためです。つまり、フリープログラムには、そのソフトウェアと同じ自由を提供するマニュアルが付属しなければなりません。ただし、本利用許諾契約書は、ソフトウェアマニュアルに制限されるものではありません。主題であるか否か、または印刷された本として発行されるか否かに関わらず、任意のテキスト著作物に使用することができます。本利用許諾契約書は、その目的が指示または参照に置かれている著作物に主に使用することを推奨します。
 </para>
    <bridgehead renderas="sect4">
    1. 適用範囲と定義
  </bridgehead>
    <para>
  本利用許諾契約書は、この利用許諾の条項に従って頒布できることを定めた著作権者の通告が記載されている任意のメディアにおけるマニュアルまたは他の著作物に適用されます。そのような通告は、その著作物をここに記載されている条件に従って使用するための世界的な無償の利用許諾を無期限で付与します。次に示す「文書」は、そのような任意のマニュアルまたは著作物を指します。その公衆ユーザはいずれも被許諾者であり、「利用者」と呼ばれます。利用者は、著作権法に従った許可が必要になるような方法で著作物を複製、変更または頒布する場合に、利用許諾を受け入れます。
 </para>
    <para>
  文書の「変更された版」とは、そのまま複製されるか、変更または別の言語に翻訳された(またはその両方)文書あるいはその一部を含んだ著作物のことです。
 </para>
    <para>
  「二次セクション」は、文書の発行者または作者と文書の全体的な主題(または関連事項)との関係のみを示す文書の名前付き付録または前付け部分です。総体的な主題に直接関わる内容は含まれていません。(したがって、文書が部分的に数学のテキストブックになっている場合、二次セクションでは数学について説明されない場合があります)。関係には、主題または関連事項との歴史的なつながり、あるいはそれらに関する法的、商的、哲学的、倫理的、政治的位置付けが含まれる場合があります。
 </para>
    <para>
  「不変セクション」は、文書が本利用許諾契約書の条件の下でリリースされる旨を述べている通告において、そのタイトルが不変セクションのものとして指定されている、ある特定の二次セクションです。セクションが、すでに説明した二次セクションの定義に一致しない場合は、不変として指定することはできません。文書には、不変セクションが含まれない場合があります。文書で不変セクションを特定しない場合、不変セクションは含まれません。
 </para>
    <para>
  「カバーテキスト」とは、文書が本利用許諾契約書の条件の下でリリースされる旨を述べている通告において、表カバーテキストまたは裏カバーテキストとして列挙されている、ある一定の短い文章のことです。表カバーテキストは、最大で5語、裏カバーテキストは、最大で25語によって構成できます。
 </para>
    <para>
  文書の「透過的な複製」とは、その仕様が一般の利用者にとって入手可能で、一般的なテキストエディタまたは一般的な描画プログラム(画素で構成される画像用)、あるいは広く使用されている図面エディタ(図面用)で文書を直接改訂するのに適した形式で表される機械可読の複製のことです。テキストフォーマッタへの入力またはテキストフォーマッタへの入力に適したさまざまな形式への変換に適していることも前提になります。読者による以後の変更を阻止または妨げるようにマークアップまたはマークアップのない状態が調整されている、他の点では透過的なファイル形式で行われた複製は、透過的な複製ではありません。イメージ形式は、相当量のテキストに使用されている場合、透過的ではありません。「透過的」ではない複製は、「不透明」と呼ばれます。
 </para>
    <para>
  透過的な複製に適した形式として、マークアップのないプレーンなASCII、Texinfo入力形式、LaTeX入力形式、一般に取得可能なDTDを使用するSGMLまたはXML、標準に準拠したHTML、人為的変更用のPostScriptまたはPDFがあります。透過的なイメージ形式には、PNG、XCF、JPGが含まれます。不透明な形式には、独自のワードプロセッサのみで読み取りおよび編集を行える独自の形式、DTDまたは処理(またはその両方)ツールを一般に取得できないSGMLまたはXML、機械生成HTML、出力のみを目的として一部のワードプロセッサによって作成されるPostScriptまたはPDFが含まれます。
 </para>
    <para>
  「タイトルページ」とは、印刷された本の場合、タイトルページ自体、および本利用許諾契約書でタイトルページに表示することが要求されるマテリアルを読みやすいように保持するために必要な以降のページのことを指します。そのようなタイトルページがない形式の著作物の場合、「タイトルページ」は、本文の開始部分に先行する、著作物のタイトルを最も顕著に表している部分の近くにあるテキストのことを指します。
 </para>
    <para>
  「XYZという表題の付いた」セクションとは、そのタイトルが正確にXYZになっているか、またはXYZを別の言語に翻訳しているテキストに続いてカッコ付きのXYZが含まれている文書の名前付きサブユニットのことです。(ここで、XYZは、次に示すように、「謝辞」、「献辞」、「推薦」、「履歴」などの特定のセクション名を表します)。文書を変更するときに、そのようなセクションの「タイトルを保存する」とは、この定義に従って「XYZという表題の付いた」セクションが残されることを表します。
 </para>
    <para>
  文書では、本利用許諾契約書が文書に適用される旨を述べている通告の付近に保証の放棄を含めることができます。保証の放棄条項は、本利用許諾契約書内の参照によって、保証の放棄に関してのみ組み込まれると見なされます。つまり、これらの保証の放棄条項がもつ可能性のある他のいかなる含意も無効であり、本利用許諾契約書の意味にまったく影響を与えません。
 </para>
    <bridgehead renderas="sect4">
    2. そのままの複製
  </bridgehead>
    <para>
  利用者は、商用か否かを問わず、任意のメディアにおいて文書を複製または頒布することができます。その際に、本利用許諾契約書、著作権表示、および本利用許諾契約書が文書に適用される旨を述べる利用許諾通告をすべての複製で再生し、本利用許諾契約書の条件に他のいかなる条件も追加しないことが前提条件になります。利用者は、技術的手段によって、作成または頒布する複製の読み込みまたはさらなる複製を妨げたり、制御したりすることはできません。ただし、複製と引き換えに対価を受け取ることができます。十分に大量の複製を頒布する場合は、セクション3の条件に従う必要もあります。
 </para>
    <para>
  すでに述べた同じ条件に従って複製を貸与したり、複製を公開したりすることもできます。
 </para>
    <bridgehead renderas="sect4">
    3. 大量の複製
  </bridgehead>
    <para>
  発行する文書の印刷した複製(または、通常、印刷したカバーをもつメディアに含まれた複製)が100部を超え、文書の利用許諾通告でカバーテキストを必要とする場合は、すべてのカバーテキスト(表カバーの表カバーテキスト、裏カバーの裏カバーテキスト)を明瞭かつ読みやすく記載したカバーに文書の複製を同封する必要があります。また、両方のカバーでは、これらの複製の発行者として、利用者を読みやすい状態で明確に識別しなければなりません。表カバーには、フルタイトルを記述し、タイトルのすべての語が同等に目立つようにする必要があります。カバーには他のマテリアルを追加することもできます。カバーに限って変更を行った場合の複製は、文書のタイトルが保持されていて、これらの条件を満たしている限り、他の点に関してそのままの複製と見なすことができます。
 </para>
    <para>
  いずれかのカバーで、必要なテキストが多すぎて、読みやすい状態に収まらない場合は、列挙されている最初の部分(問題なく収まる分)を実際のカバーに記載し、残りの部分を隣接ページに入れます。
 </para>
    <para>
  文書の不透明な複製を100部以上公開または頒布する場合は、それぞれの不透明な複製とともに機械可読の透過的な複製を含めるか、それぞれの不透明な複製内あるいはその複製とともに、ネットワークの一般利用者が標準的な一般ネットワークプロトコルを使用して、追加マテリアルのない文書の完全な透過的複製をダウンロードするときにアクセスできるコンピュータネットワークの場所を明記する必要があります。後者のオプションを使用する場合は、不透明な複製の大量頒布を開始するときに十分慎重な手順を取り、この透過的な複製が、その版の不透明な複製を最後に一般頒布した後(直接またはエージェントや小売業者を通じて)少なくとも1年間、指定した場所で継続的にアクセス可能となるように配慮する必要があります。
 </para>
    <para>
  大量の複製を再頒布する時点よりもかなり前に、文書の作者に連絡して、文書の更新版を提供する機会を与えることが要求されますが、必須ではありません。
 </para>
    <bridgehead renderas="sect4">
    4. 変更
  </bridgehead>
    <para>
  文書の変更された版を、すでに述べた第2項および第3項の条件に従って複製および頒布することができます。その際は、本利用許諾契約書に確実に従って、変更された版をリリースし、変更された版が文書の役割を担うようにして、その複製を所要する任意の利用者に変更された版の頒布および変更の利用許諾を与えることが前提になります。また、変更された版で次のことを行う必要があります。
 </para>
    <orderedlist numeration="upperalpha" spacing="normal">
      <listitem>
        <para>
    タイトルページ(カバーがある場合はカバー上も含める)で、文書、および以前の版の文書(以前の版がある場合は、その旨、文書の履歴セクションに列挙する)と識別されるタイトルを使用します。前の版と同じタイトルは、その版の元の発行者が許可を与えた場合に、使用することができます。
   </para>
      </listitem>
      <listitem>
        <para>
    タイトルページ上に、この要件から解放されない限り、変更された版において変更の著者としての責任を担う1人以上の人またはエンティティとともに、文書の筆頭著者を少なくとも5人、作者として列挙します(5人に満たない場合は、その筆頭著者のすべて)。
   </para>
      </listitem>
      <listitem>
        <para>
    タイトルページ上に、変更された版の発行者の名前を、発行者として記載します。
   </para>
      </listitem>
      <listitem>
        <para>
    文書のすべての著作権表示を保持します。
   </para>
      </listitem>
      <listitem>
        <para>
    変更に関する適切な著作権表示を、他の著作権表示の隣に追加します。
   </para>
      </listitem>
      <listitem>
        <para>
    著作権表示の直後に、本利用許諾契約書の条項に従って変更された版を利用するための許可を一般利用者に与える利用許諾通告を、次の補遺に示す形式で含めます。
   </para>
      </listitem>
      <listitem>
        <para>
    その利用許諾通告に、不変セクションの全リスト、および文書の利用許諾通告で指定されている必須カバーテキストを保持します。
   </para>
      </listitem>
      <listitem>
        <para>
    本利用許諾契約書の変更されていない複製を含めます。
   </para>
      </listitem>
      <listitem>
        <para>
    「履歴」という表題のセクションを保持して、そのタイトルを保持し、タイトルページに記載されているとおりに、変更された版のタイトル、年度、新しい作者、発行者を少なくとも示す項目を追加します。文書に履歴というセクションがない場合は、そのタイトルページに記載されているとおりに文書のタイトル、年度、作者、発行者を示すセクションを作成し、前の文章に記載されているとおりに変更された版を示す項目を追加します。
   </para>
      </listitem>
      <listitem>
        <para>
    文書の透過的な複製に一般利用者がアクセスできるように文書で指定されている場合は、そのネットワークの場所、およびその文書の基盤となった前の版に対応して文書で指定されているネットワークの場所を保持します。これらは、「履歴」セクションに配置することができます。文書自体よりも4年以上前に発行された著作物の場合、または参照されているその版の元の発行者が許可を与えている場合は、そのネットワークの場所を省略することができます。
   </para>
      </listitem>
      <listitem>
        <para>
    「謝辞」または「献辞」という表題のセクションの場合は、そのセクションのタイトルを保持し、セクション内に、それぞれの貢献者謝辞またはその中の献辞(またはその両方)のすべての内容と意味合いを保持します。
   </para>
      </listitem>
      <listitem>
        <para>
    文書のすべての不変セクションを保持し、そのテキストおよびタイトルを未変更のままにします。セクション番号またはそれと同等の要素は、セクションタイトルの一部と見なされません。
   </para>
      </listitem>
      <listitem>
        <para>
    「推薦」という表題の任意のセクションを削除します。そのようなセクションは、変更された版に含めることはできません。
   </para>
      </listitem>
      <listitem>
        <para>
    既存のセクションのタイトルを変更して、「推薦」という表題にしたり、タイトルが不変セクションと矛盾したりしないようにします。
   </para>
      </listitem>
      <listitem>
        <para>
    保証の放棄を保持します。
   </para>
      </listitem>
    </orderedlist>
    <para>
  変更された版に、二次セクションと見なされ、文書から複製されたマテリアルを含まない新しい前付けセクションまたは付録が含まれる場合は、これらの一部またはすべてを任意に「不変」として指定することができます。これを行うには、変更された版の利用許諾表示内で列挙されている不変セクションにそのタイトルを追加します。これらのタイトルは、他のすべてのセクションタイトルと異なっている必要があります。
 </para>
    <para>
  「推薦」という表題のセクションを追加することができますが、その際は、変更された版のさまざまな当事者による推薦以外の要素が含まれていないことが前提になります。たとえば、校正者によるコメント、または文が標準的な信頼できる定義として組織によって承認されていることを示すという宣言文などが相当します。
 </para>
    <para>
  表カバーテキストとしての最大5語の短い文、および裏カバーテキストとしての最大25語の短い文を、変更された版のカバーテキストのリストの終わりに追加できます。表カバーテキストの短い1文および裏カバーテキストの短い1文のみを、1つのエンティティが追加できます(またはエンティティによって行われた調整を通じて)。文書に、利用者または利用者が関わる同じエンティティによって行われた調整を通じて前に追加された同じカバーのカバーテキストがすでに含まれている場合は、別のものを追加することはできませんが、古いものを置き換えることができます。ただし、その古いものを追加した前の発行者から明示的な許可を得る必要があります。
 </para>
    <para>
  文書の作者および発行者は、本利用許諾契約書により、その名前を得るために使用したり、変更された版の推薦を主張または暗示したりする許可を与えるものではありません。
 </para>
    <bridgehead renderas="sect4">
    5. 文書の結合
  </bridgehead>
    <para>
  文書は、すでに述べた変更された版に関するセクション4の条件に従って、本利用許諾契約書の下でリリースされた他の文書と結合することができます。その際は、その組み合わせの中に、元の全文書のすべての不変セクションを未変更のまま含めて、そのすべてを結合された著作物の不変セクションとしてその利用許諾表示に列挙し、そのすべての保証の放棄を保持することが前提となります。
 </para>
    <para>
  結合された著作物には、本利用許諾契約書の複製を1つのみ含める必要があります。複数の同一の不変セクションは、単一の複製で置き換えることができます。同じ名前だが内容の異なる複数の不変セクションがある場合は、そのような各セクションのタイトルを固有なものにします。その際は、その終わりに、カッコ付きで、そのセクションの元の作者または発行者の名前(既知の場合)、あるいは固有の番号を追加します。不変セクションのリスト内のセクションタイトルには、結合された著作物の利用許諾表示の場合と同じ調整を加えます。
 </para>
    <para>
  組み合わせでは、さまざまな元の文書の「履歴」という表題のセクションを結合して、1つの「履歴」というセクションを構築する必要があります。同じように、「謝辞」という表題のセクション、および「献辞」という表題のセクションも結合します。「推薦」という表題のすべてのセクションを削除する必要があります。
 </para>
    <bridgehead renderas="sect4">
    6. 文書のコレクション
  </bridgehead>
    <para>
  文書および本利用許諾契約書の下でリリースされた他の文書から成るコレクションを作成して、さまざまな文書に含まれる本利用許諾契約書の個々の複製を、コレクションに含まれる単一の複製で置き換えることができますが、他のすべての点での各文書のそのままの複製に関する本利用許諾契約書の規則に従うことが前提になります。
 </para>
    <para>
  そのようなコレクションから単一の文書を抽出して、その文書を本利用許諾契約書に従って個々に頒布することができますが、その際は、本利用許諾契約書の複製を抽出した文書に挿入して、その文書のそのままの複製に関するその他のすべての点で、本利用許諾契約書に従う必要があります。
 </para>
    <bridgehead renderas="sect4">
    7. 独立した著作物の集積
  </bridgehead>
    <para>
  文書またはその派生物を他の個別および独立した文書または著作物とともに、ストレージまたは頒布メディア内またはそのボリューム上に蓄積することを「集積」と呼びます。その場合は、個々の著作物の許可を超えてその蓄積の利用者の法的権限を制限することに、蓄積による著作権を使用しないことが前提になります。文書が集積に含まれる場合、本利用許諾契約書は、それ自体が文書の派生著作物ではない集積内の他の著作物に適用されません。
 </para>
    <para>
  セクション3のカバーテキスト要件が文書のこれらの複製に適用可能であり、文書が集積全体の半分に満たない場合は、文書のカバーテキストを、集積内の文書のカバー、または文書が電子形式の場合は、電子的な同等のカバーに配置することができます。それ以外の場合は、集積全体の印刷されたカバー上に表示する必要があります。
 </para>
    <bridgehead renderas="sect4">
    8. 翻訳
  </bridgehead>
    <para>
  翻訳は一種の変更と見なされるため、セクション4の条件に従って文書の翻訳を配布することができます。不変セクションを翻訳で置き換えるには、著作権者からの特別な許可が必要ですが、これらの不変セクションの元のバージョンのほかに、一部またはすべての不変セクションの翻訳を含めることができます。本利用許諾契約書、文書内のすべての利用許諾表示、および保証の放棄の翻訳を含めることができますが、その際は、本利用許諾契約書の元の英語版、およびそれらの利用許諾表示と保証の放棄の元の版も含めることが前提になります。本利用許諾契約書、利用許諾表示、または保証の放棄の翻訳と元の版との間に不一致がある場合は、元の版が優先されます。
 </para>
    <para>
  文書内のセクションに、「謝辞」、「献辞」、または「履歴」という表題が付いている場合は、そのタイトルを保持する(セクション1)ための要件(セクション4)により、通常は実際のタイトルを変更する必要があります。
 </para>
    <bridgehead renderas="sect4">
    9. 終了
  </bridgehead>
    <para>
  利用者は、本利用許諾契約書に明示的に記載されている形態を除き、文書を複製、改変、二次利用許諾、および頒布してはなりません。別の方法で文書を複製、改変、二次利用許諾、または頒布しようとするのは無効であり、本利用許諾契約書の下で利用者の権利は自動的に消滅します。ただし、本使用許諾の下で利用者から複製物または権利を受領した関係者は、条項を遵守している限り、権利が消滅することはありません。
 </para>
    <bridgehead renderas="sect4">
    10. 本利用許諾契約書の将来の改訂
  </bridgehead>
    <para>
  フリーソフトウェア財団は、GNUフリー文書利用許諾契約書(GFDL)の新版または改訂版を随時公表することがあります。そのような新版は、性格的には現行版と似たものになりますが、新たな問題や懸案事項に対応するために細部が異なる可能性があります。<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.gnu.org/copyleft/"/>を参照してください。
 </para>
    <para>
  本利用許諾契約書の各版には、区別するための版番号が設定されます。文書に、それに適用される本利用許諾契約書の特定の版番号と「後継版」が指定されている場合、利用者は、選択によって、その指定された版の条項またはフリーソフトウェア財団から公開される後継版の条項(ドラフトではない)に従うことになります。文書に、本利用許諾契約書の版番号が指定されていない場合、利用者は、フリーソフトウェア財団からこれまでに公開された任意の版(ドラフトではない)を選択することができます。
 </para>
    <bridgehead renderas="sect4">
    補遺: 本利用許諾書をご使用の文書に使用する方法
  </bridgehead>
    <screen>Copyright (c) YEAR YOUR NAME.
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
A copy of the license is included in the section entitled &#x201C;GNU
Free Documentation License&#x201D;.</screen>
    <para>
  不変セクション、表カバーテキスト、および裏カバーテキストがある場合は、「with...Texts」の行を次のように置き換えます。
 </para>
    <screen>with the Invariant Sections being LIST THEIR TITLES, with the
Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.</screen>
    <para>
  カバーテキストのない不変セクションが含まれている場合、またはこの3つの他の組み合わせの場合は、その2つの代替要素をマージして状況に合わせます。
 </para>
    <para>
  文書にプログラムコードの重要な例が含まれている場合は、GNU一般公衆利用許諾契約書(GPL)などの選択したフリーソフトウェアの利用許諾に従って、これらの例を平行してリリースし、フリーソフトウェアでのその利用を許可することを推奨します。
</para>
  </appendix>
</article>
