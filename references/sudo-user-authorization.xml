<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: https://github.com/SUSE/doc-sle/blob/main/xml/adm_sudo.xml -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="sudo-user-authorization"
 role="reference" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <title>&sudo; configuration basics</title>
  <info>
    <meta name="maintainer" content="jana.jaeger@suse.com" its:translate="no"/>
    <abstract>
      <para>
        Before you start editing &sudo; configuration files or creating your 
        own, learn about the basic <filename>sudoers</filename> configuration 
        settings.
      </para>
    </abstract>
  </info>
  <section xml:id="sudo-user-authorization-syntax">
    <title>Basic <filename>sudoers</filename> configuration syntax</title>
    <para>
    The <filename>sudoers</filename> configuration files contain two types of 
    options: strings and flags. While strings can contain any value, flags can 
    be turned either ON or OFF. The most important syntax constructs for 
    <filename>sudoers</filename> configuration files are as follows:
    </para>
    <screen>
# Everything on a line after # is ignored<co xml:id="co-hash-ignore"/>
Defaults !insults # Disable the insults flag<co xml:id="co-toggle-flag"/>
Defaults env_keep += "DISPLAY HOME" # Add DISPLAY and HOME to env_keep<co xml:id="co-env-keep"/>
tux ALL = NOPASSWD: /usr/bin/frobnicate, PASSWD: /usr/bin/journalctl<co xml:id="co-full-entry"/>
    </screen>
    <calloutlist>
      <callout arearefs="co-hash-ignore">
        <para>
          There are two exceptions: <literal>#include</literal> 
          and <literal>#includedir</literal> are regular commands.
        </para>
      </callout>
      <callout arearefs="co-toggle-flag">
        <para>
          Remove the <literal>!</literal> character to set the desired flag
          to ON.
        </para>
      </callout>
      <callout arearefs="co-env-keep">
        <para>
        </para>
      </callout>
      <callout arearefs="co-full-entry">
        <para>
        </para>
      </callout>
    </calloutlist>
          <variablelist xml:id="tab-adm-sudo-options">
        <title>Useful flags and options</title>
        <varlistentry>
          <term><literal>targetpw</literal></term>
          <listitem>
            <para>
              This flag controls whether the invoking user is required to enter
              the password of the target user (ON) (for example &rootuser;) or
              the invoking user (OFF).
            </para>
<screen>Defaults targetpw # Turn targetpw flag ON</screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><literal>rootpw</literal></term>
          <listitem>
            <para>
              If set, &sudo; prompts for the &rootuser; password. The default
              is OFF.
            </para>
<screen>Defaults !rootpw # Turn rootpw flag OFF</screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><literal>env_reset</literal></term>
          <listitem>
            <para>
              If set, &sudo; constructs a minimal environment with
              <envar>TERM</envar>, <envar>PATH</envar>, <envar>HOME</envar>,
              <envar>MAIL</envar>, <envar>SHELL</envar>,
              <envar>LOGNAME</envar>, <envar>USER</envar>,
              <envar>USERNAME</envar>, and <envar>SUDO_*</envar>. Additionally,
              variables listed in <literal>env_keep</literal> are imported from
              the calling environment. The default is ON.
            </para>
<screen>Defaults env_reset # Turn env_reset flag ON</screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><literal>env_keep</literal></term>
          <listitem>
            <para>
              List of environment variables to keep when the
              <literal>env_reset</literal> flag is ON.
            </para>
<screen>
# Set env_keep to contain EDITOR and PROMPT
Defaults env_keep = "EDITOR PROMPT"
Defaults env_keep += "JRE_HOME" # Add JRE_HOME
Defaults env_keep -= "JRE_HOME" # Remove JRE_HOME
</screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><literal>env_delete</literal></term>
          <listitem>
            <para>
              List of environment variables to remove when the
              <literal>env_reset</literal> flag is OFF.
            </para>
<screen>
# Set env_delete to contain EDITOR and PROMPT
Defaults env_delete = "EDITOR PROMPT"
Defaults env_delete += "JRE_HOME" # Add JRE_HOME
Defaults env_delete -= "JRE_HOME" # Remove JRE_HOME
</screen>
          </listitem>
        </varlistentry>
      </variablelist>
  </section>
    <section xml:id="sudo-user-authorization-rules">
    <title>Basic <filename>sudoers</filename> rules</title>
    <para>
      A paragraph of text.
    </para>
  </section>
</topic>
