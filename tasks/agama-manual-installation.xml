<?xml version="1.0" encoding="UTF-8"?>
<!-- This file originates from the project https://github.com/openSUSE/doc-kit -->
<!-- This file can be edited downstream. -->
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
  <!ENTITY agama.iso  "agama-installer-<phrase xmlns='http://docbook.org/ns/docbook' arch='power'>&ppc64le;</phrase><phrase arch='zseries'>s390x</phrase><phrase arch='x86_64'>x86_64</phrase>-11.0.0-SLE-Beta1.iso">
  <!ENTITY install.iso "SLES-16.0-<phrase xmlns='http://docbook.org/ns/docbook' arch='power'>&ppc64le;</phrase><phrase arch='zseries'>s390x</phrase><phrase arch='x86_64'>x86_64</phrase>-Beta1.install.iso">
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="agama-manual-installation"
 role="task" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Installing &productname; using &agama;</title>
    <!-- can be changed via merge
      in the assembly -->
    <!-- add author's e-mail -->
    <meta name="souvik.sarkar@suse.com" content="" its:translate="no"/>
    <abstract>
      <!-- can be changed via merge in the assembly -->
      <para>
        This section describes how to install &productname; using the &agama;&dash;based ISO image
        file.
      </para>
    </abstract>
  </info>
  <section xml:id="agama-manual-installation-introduction">
    <title>Introduction</title>
    <para>
      The following sections describe the &agama;&dash;based manual installation procedure for
      &productname;. The information applies to installation on both bare metal and virtual
      machines.
    </para>
  </section>
  <section xml:id="agama-manual-installation-requirements">
    <title>Requirements</title>
    <itemizedlist>
      <listitem>
        <para>
          An &agama;&dash;based ISO image file for supported versions of &productname;. You can
          download it from the &scc; and verify its checksum to ensure its integrity.
        </para>
        <note>
          <title>Available images for products</title>
          <para>
            The &agama;&dash;based installation image is available for &productname;
            &productnumber; and later versions.
          </para>
        </note>
      </listitem>
    </itemizedlist>
  </section>
  <section xml:id="agama-manual-installation-procedure">
    <title>Manually installing &productname; using &agama;</title>
    <para>
      To manually install &productname; using &agama;, perform the following steps:
    </para>
    <procedure>
      <title>Manual installation of &sle; using &agama;</title>

      <!-- power-specific steps -->
      <step arch="power">
        <para>
          Copy the ISO image to the VIOS server:
        </para>
        <screen>&prompt.user;<command>scp</command> <filename>&agama.iso;</filename> padmin@<replaceable>VIOS_SERVER</replaceable></screen>
        <para>
          Replace <replaceable>VIOS_SERVER</replaceable> with the hostname or IP address of your
          VIOS server.
        </para>
      </step>
      <step arch="power" xml:id="st-power-virtual-optical-device">
        <para>
          Create a virtual optical device and load the ISO in the virtual device at the VIOS
          server:
        </para>
<screen><prompt>(VIOS)$</prompt> <command>mkvopt</command> -name sles16-offline -file <filename>&agama.iso;</filename> -ro
<prompt>(VIOS)$</prompt> <command>loadopt</command> -f -release -disk sles16-offline -vtd <replaceable>vcdXY</replaceable></screen>
        <para>
          Replace <replaceable>vcdXY</replaceable> with your virtual device unit attached to the
          LPAR you want to boot.
        </para>
      </step>
      <step arch="power">
        <para>
          Boot the system from the attached virtual device. Select
          <menuchoice><guimenu>Select Boot Options</guimenu>
          <guimenu>Select Install/Boot Device</guimenu>
          <guimenu>CD/DVD</guimenu>
          <guimenu>List All Devices</guimenu></menuchoice>
          and select the virtual optical device you created in
          <xref linkend="st-power-virtual-optical-device"/>.
          Then select <guimenu>Normal Boot Mode</guimenu> and confirm your
          selection.
        </para>
      </step>
      <step arch="power">
        <para>
          Log into the console to get the root password and IP address.
        </para>
        <substeps>
          <step>
            <para>
              Select <guimenu>agama&dash;installer</guimenu> and press
              <keycap function="enter"/> to boot the system.
            </para>
            <informalfigure>
              <mediaobject>
                <textobject role="description"><phrase>Pre&dash;installation boot menu</phrase>
                </textobject>
                <imageobject role="fo">
                  <imagedata fileref="agama-installation-sles-ppc-boot-agama.png" width="100%"/>
                </imageobject>
                <imageobject role="html">
                  <imagedata fileref="agama-installation-sles-ppc-boot-agama.png" width="100%"/>
                </imageobject>
              </mediaobject>
            </informalfigure>
          </step>
          <step>
            <para>
              When booting finishes, the IP address and root password are displayed.
            </para>
            <informalfigure>
              <mediaobject>
                <textobject role="description"><phrase>Pre&dash;installation boot menu</phrase>
                </textobject>
                <imageobject role="fo">
                  <imagedata fileref="agama-installation-sles-ppc-boot-finish.png" width="100%"/>
                </imageobject>
                <imageobject role="html">
                  <imagedata fileref="agama-installation-sles-ppc-boot-finish.png" width="100%"/>
                </imageobject>
              </mediaobject>
            </informalfigure>
          </step>
        </substeps>
      </step>
      <step arch="power">
        <para>
          Open a browser pointing to the given URL in the console. Enter the &rootuser; password
          and proceed with the installation.
        </para>
      </step>
      <!-- End of power-specific steps -->

      <!-- Z Series steps-->
      <step xml:id="st-z-agama-iso" arch="zseries">
        <para>
          Download &agama.iso; <filename>&agama.iso;</filename> and mount it:
        </para>
<screen>&prompt.sudo;<command>mount</command> -o loop <filename>&agama.iso;</filename> ./install/agama/</screen>
      </step>
      <step xml:id="st-z-install-iso" arch="zseries" performance="optional">
        <para>
          For installation in an air-gapped environment or without registration, also
          download <filename>&install.iso;</filename> and mount it.
        </para>
<screen>&prompt.sudo;<command>mount</command> -o loop <filename>&install.iso;</filename> ./install/agama-offline/install/</screen>
      </step>
      <step arch="zseries">
        <para>
          Use the following parmfile to start the installation:
        </para>
        <example>
          <title>Example parmfile</title>
<screen>root=live:ftp://10.144.55.15/install/online.iso<co xml:id="co-parmfile-source"/>
ip=10.144.136.2<co xml:id="co-parmfile-ip"/>::10.144.136.254:24<co xml:id="co-parmfile-gw"/>:SLE16-Beta1:enc800:none
rd.zdev=qeth,0.0.0800:0.0.0801:0.0.0802,layer2=1,portno=0
cio_ignore=all,!condev,!0.0.0160 nameserver=10.144.53.53<co xml:id="co-parmfile-dns"/>
live.password=linux<co xml:id="co-parmfile-pw"/> rd.zdev=dasd,0.0.0160</screen>
        </example>
        <para>
          Adjust your parmfile accordingly.
        </para>
        <calloutlist>
          <callout arearefs="co-parmfile-source">
            <para>
              URI of the installer ISO mounted in <xref linkend="st-z-agama-iso"/>
            </para>
          </callout>
          <callout arearefs="co-parmfile-ip">
            <para>
              IP address of the system you install. If you do not set an address, it will be
              assigned with DHCP and displayed on the console after boot. As the console is hard to
              read on <command>x3270</command>, configuring the network in the parmfile is
              recommended.
            </para>
          </callout>
          <callout arearefs="co-parmfile-gw">
            <para>
              IP address of the gateway for the system
            </para>
          </callout>
          <callout arearefs="co-parmfile-dns">
            <para>
              IP address the DNS server for the system
            </para>
          </callout>
          <callout arearefs="co-parmfile-pw">
            <para>
              Password for the system administrator &rootuser;. If you do not set a password, a
              random password will be generated and displayed on the console after boot. As the
              console is hard to read on <command>x3270</command>, setting a &rootuser; password in
              the parmfile is recommended.
            </para>
          </callout>
        </calloutlist>
      </step>
      <step arch="zseries" performance="optional">
        <para>
          For installation in an air-gapped environment or without registration, add the
          <literal>agama.install_url</literal> parameter to the parmfile to install from &install.iso;
          mounted in <xref linkend="st-z-install-iso"/>:
        </para>
        <example>
        <title>Example parmfile for installation in an air-gapped environment</title>
 <screen>root=live:ftp://<replaceable>10.144.55.15</replaceable>/install/online.iso
agama.install_url=ftp://<replaceable>10.144.55.15</replaceable>/install/agama-offline/install
ip=<replaceable>10.144.136.2::10.144.136.254:24:SLE16-Beta1:enc800:none</replaceable>
rd.zdev=qeth,0.0.0800:0.0.0801:0.0.0802,layer2=1,portno=0
cio_ignore=all,!condev,!0.0.0160 nameserver=<replaceable>10.144.53.53</replaceable>
live.password=linux rd.zdev=dasd,0.0.0160</screen>
        </example>
      </step>
      <step arch="zseries">
        <para>
          Open a browser pointing to the given IP address from the parmfile. Enter the &rootuser;
          password and proceed with the installation.
        </para>
      </step>
      <!-- End of Z Series steps -->

      <!-- Begin x_86_64 steps -->
      <step arch="x86_64">
        <para>
          Select a bootable media and start the installation process.
        </para>
        <stepalternatives>
          <step>
            <para>
              For a bare metal server, select the device or storage volume from which to boot.
            </para>
          </step>
          <step>
            <para>
              For a virtual machine guest, select the path to the image file and create a virtual
              machine with a configuration that is appropriate for the anticipated workload.
            </para>
          </step>
        </stepalternatives>
      </step>
      <step arch="x86_64">
        <para>
          In the &grub; boot menu, select <guimenu>agama&dash;installer</guimenu>.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Pre&dash;installation &grub; boot menu</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-x86-64-grub2-boot-menu-pre-installation.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-x86-64-grub2-boot-menu-pre-installation.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <!-- End of x86_64 steps -->

      <step>
        <para>
          Select the product that you want to install. Accept the license to continue.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description">
              <phrase>Select a product</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-select-product.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-select-product.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
        <note>
          <para>
            In this example procedure, we select &productname; &productnumber;. However, the
            procedure for &sles; and &sles4sap; is the same.
          </para>
        </note>
      </step>
      <step>
        <para>
          Provide a secure <guimenu>Password for root user</guimenu> and select <guimenu>Accept</guimenu>.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Setup root user authentication</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-set-root-password.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-set-root-password.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step>
        <para>
          The overview with the most relevant installation settings is shown. Adjust the settings
          by selecting the category from the menu on the left or directly proceed with the installation.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Installation settings overview</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-overview.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-overview.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step>
        <para>
          Register your product. Enter a registration code and optionally a valid email address.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Registration</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-registration.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-registration.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
        <note>
          <title>Optional registration for images signed with the developer's key</title>
          <para>
            Certain images that are signed with the developer's key may allow you to skip
            registration before installation. If your product's image supports installation without
            registration, you may see a pop-up similar to the following:
          </para>
          <informalfigure>
            <mediaobject>
              <textobject role="description"><phrase>Using images signed by developer's key</phrase>
              </textobject>
              <imageobject role="fo">
                <imagedata fileref="agama-installation-sles-sap-no-reg-dev-key-sign.png" width="100%"/>
              </imageobject>
              <imageobject role="html">
                <imagedata fileref="agama-installation-sles-sap-no-reg-dev-key-sign.png" width="100%"/>
              </imageobject>
            </mediaobject>
          </informalfigure>
          <para>
            To install without registration, select <guimenu>Trust</guimenu> on the pop-up.
          </para>
        </note>
      </step>
      <step performance="optional">
        <para>
          Adjust your localization settings such as language, keyboard layout and time zone.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Localization</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-localization.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-localization.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step performance="optional">
        <para>
          Configure your network settings. To edit an existing network connection, click the three dots.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Network</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-network.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-network.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step arch="zseries">
        <para>
          Configure your storage
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Storage</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-storage.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-storage.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step performance="optional">
        <para>
          Add additional software to install such as the &kvm; hypervisor or &cockpit; system management service.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Software</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-software.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-software.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step performance="optional">
        <para>
          Create a non-root user. Click <guilabel>Define a user now</guilabel>
          and enter details such as user name and password.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Users</phrase>
              </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-users.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-users.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
        <para>
          Additionally, you can also change the &rootuser; password and upload
          a public SSH key for key-based authentication.
        </para>
      </step>
      <step>
        <para>
          Click <guimenu>Install</guimenu> and confirm
          To start the installation. 
          In the <guimenu>Confirm Installation</guimenu> pop-up, select
          <guimenu>Continue</guimenu>.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Confirm installation</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-confirm-installation.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-confirm-installation.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step>
        <para>
          Wait for the system installation to complete. It takes around 30 minutes to complete the
          installation. You can use the drop-down list in the top right corner of the window to
          view the logs and system messages.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>System installation</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-system-installation.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-system-installation.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
        <tip>
          <title>Installation logs</title>
          <para>
          You can use the drop-down list in the top right corner of the window to
          view the logs and system messages.
          </para>
        </tip>
      </step>
      <step>
        <para>
          Once the installation is complete, select <guimenu>Reboot</guimenu>.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Complete installation</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-complete-installation.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-complete-installation.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step arch="x86_64">
        <para>
          Using the &grub; boot menu, boot into the newly installed system.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Reboot</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-x86-64-grub2-boot-menu-post-installation.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-x86-64-grub2-boot-menu-post-installation.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
    </procedure>
  </section>
  <section xml:id="sle-agama-manual-installation-x86-64-summary">
    <title>Summary</title>
    <para>
      After successful configuration checks, product registration, installation and reboot, verify
      that you can log in and use your system.
    </para>
    <procedure>
      <title>Verifying the system after installation</title>
      <step>
        <para>
          Log in to the system as root.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Server login as root</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-x86-64-root-login.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-x86-64-root-login.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
      <step>
        <para>
          To verify that your system is working as expected, run a few basic commands.
        </para>
        <informalfigure>
          <mediaobject>
            <textobject role="description"><phrase>Run basic commands</phrase>
            </textobject>
            <imageobject role="fo">
              <imagedata fileref="agama-installation-sles-x86-64-run-commands.png" width="100%"/>
            </imageobject>
            <imageobject role="html">
              <imagedata fileref="agama-installation-sles-x86-64-run-commands.png" width="100%"/>
            </imageobject>
          </mediaobject>
        </informalfigure>
      </step>
    </procedure>
  </section>
  <!-- section xml:id="task-example-troubleshooting">
    <title>Troubleshooting</title>
    <para>
    Add some troubleshooting information, if applicable.
    </para>
    </section-->
</topic>
