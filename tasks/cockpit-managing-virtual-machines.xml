<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="task-creating-vm-cockpit"
 role="task" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Managing virtual machines using &cockpit;</title>
    <meta name="maintainer" content="shalaka.harne@suse.com" its:translate="no"/>
    <abstract>
      <para>The &cockpit; web console allows you to view, filter, and manage virtual machines (VMs), storage pools, and networks. You can also use this interface to import existing VMs and activate, deactivate, and delete your virtualization resources.</para>
    </abstract>
  </info>
  <section><title>Modifying a virtual machine configuration</title>
    <para>
    To modify a virtual machine configuration,
  </para>
  <procedure>
    <step>
      <para>Navigate to the <guimenu>Virtual machines</guimenu> page.</para>
    </step>
    <step>
      <para>
        Click the required VM name.
      </para>
    </step>
    <step><para>In the <guimenu>Overview</guimenu> section,</para><itemizedlist>
    <listitem><para>To modify the <guimenu>Memory</guimenu>, click <guimenu>edit</guimenu> and change the storage and memory and click <guimenu>Save</guimenu>.</para></listitem>
    <listitem><para>To modify the <guimenu>Boot order</guimenu>, click <guimenu>edit</guimenu> and select the up and down arrow to set the boot order and click <guimenu>Save</guimenu>.</para></listitem>
    <listitem><para>To modify the <guimenu>Watchdog</guimenu> device type, click <guimenu>edit</guimenu>, select the action and click <guimenu>Save</guimenu>.</para>
      <para>Watchdogs act when systems stop responding. To use this virtual watchdog device, the guest system also needs to have an additional driver and a running watchdog service.</para>
    <para>The available options are</para>
      <itemizedlist><listitem><para><guimenu>Reset</guimenu> performs a hard reset of the VM.</para></listitem>
      <listitem><para><guimenu>Power off</guimenu> shuts down the VM. Use this if a hung VM might cause data corruption on shared storage.</para></listitem>
      <listitem><para><guimenu>Inject a non-maskable interrupt</guimenu> when the watchdog timer expires, the hypervisor sends an non-maskable interrupt (NMI) signal to the virtual processor.</para></listitem>
    <listitem><para><guimenu>Pause</guimenu> suspends the VM in its current state. This allows an administrator to verify VM for debugging before manual recovery.</para></listitem>
    <listitem><para><guimenu>Do nothing</guimenu> records the event in the host logs but takes no physical action on the VM.</para></listitem>  
    </itemizedlist>
      </listitem>
      <listitem><para>To modify the <guimenu>Vsock</guimenu>, click <guimenu>edit</guimenu> and modify or remove the custom identifier.</para>
      <para>Virtual socket support enables communication between the host and guest over a socket. It still requires special vsock-aware software to communicate over the socket</para>
      </listitem>
      <listitem><para>To modify the <guimenu>Firmware</guimenu>, click the firmware name, select the required firmware from the drop-down list, and click <guimenu>Save</guimenu>.</para></listitem>
    </itemizedlist></step>
   </procedure></section>
   <section>
    <title>Managing Disks</title>
  <para>You can add new disk to the VM, add an existing disk, or attach a virtual disk that already exists as a file on the host machineâ€™s file system. </para>
<section><title>Adding disks</title>
  <procedure>
    <step><para>In the <guimenu>Disks</guimenu> section, click <guimenu>Add disk</guimenu>.</para></step>
    <step><para>To create a new disk source, select <guimenu>Create new</guimenu> option in <guimenu>Source</guimenu>.</para>
    <itemizedlist><listitem><para>Select the pool name from the <guimenu>Pool</guimenu> drop-down list.</para></listitem>
    <listitem><para>Specify the new volume name in the <guimenu>Name</guimenu>.</para></listitem>
    <listitem><para>Select the disk size and format.</para></listitem>
    <listitem><para>Click <guilabel>Show additional options</guilabel> and select the cache and bus from the drop-down lists.</para></listitem>
    <listitem><para>Specify the disk identifier in <guimenu>Disk identifier</guimenu>.</para></listitem>
    </itemizedlist></step>
    <step><para>To use an existing disk source, select <guimenu>Use existing</guimenu>  option in <guimenu>Source</guimenu>.</para>
    <itemizedlist><listitem><para>Select the pool name from the <guimenu>Pool</guimenu> drop-down list.</para></listitem>
    <listitem><para>Select the new volume name from the <guimenu>Volume</guimenu> drop-down list.</para></listitem>
    <listitem><para>Click <guilabel>Show additional options</guilabel> and select the cache and bus from the drop-down lists.</para></listitem>
    <listitem><para>Specify the disk identifier in <guimenu>Disk identifier</guimenu>.</para></listitem>
    </itemizedlist></step>
   <step><para>To use custom path for the disk source, select <guimenu>Custom path</guimenu>  option in <guimenu>Source</guimenu>.</para>
    <itemizedlist><listitem><para>Select the custom path from the <guimenu>Custom path</guimenu> drop-down list.</para></listitem>
    <listitem><para>Select the device as <guimenu>Disk image file</guimenu> or <guimenu>CD/DVD disc</guimenu> from the <guimenu>Device</guimenu> drop-down list.</para></listitem>
    <listitem><para>Click <guilabel>Show additional options</guilabel> and select the cache and bus from the drop-down lists.</para></listitem>
    <listitem><para>Specify the disk identifier in <guimenu>Disk identifier</guimenu>.</para></listitem>
    </itemizedlist></step>
    <step><para>Click <guilabel>Add</guilabel>.</para>
    <para>The new disk is added for the virtual machine.</para></step>
  </procedure>
</section>
  <section><title>Modifying disks</title>
    <procedure>
      <step><para>In the <guimenu>Disks</guimenu> section, click <guimenu>Edit</guimenu> corresponding to the disk you want to modify.</para></step>
      <step><para>Select the access type as <guilabel>Read-only</guilabel> or <guimenu>Writeable</guimenu>.</para></step>
      <step><para>Select the cache and bus from the drop-down lists.</para></step>
      <step><para>Click <guimenu>Save</guimenu>.</para>
      <para>The attributes are updated.</para>
      </step>
    </procedure></section>
  <section><title>Removing disks</title><procedure>
    <step><para>In the <guimenu>Disks</guimenu> section, click three-dots icon corresponding to the disk you want to remove.</para></step>
    <step><para>Click <guimenu>Remove</guimenu>.</para></step>
    <step><para>If you want to only remove the disk from the virtual machine, click <guimenu>Remove</guimenu>.</para></step>
    <step><para>If you want to remove the disk from the virtual machine and delete the file, click <guimenu>Remove and delete file</guimenu>.</para></step>
  </procedure></section>
  </section>
   <section>
    <title>Managing Network Interfaces</title>
<para>You can add a new virtual NIC to your VM.</para>
  <section><title>Adding network interfaces</title>
    <procedure>
      <step><para>Select the interface type as <guilabel>Virtual network</guilabel>, <guilabel>Bridge to LAN</guilabel>, or <guilabel>Direct attachment</guilabel> from the drop-down list.</para>
      <itemizedlist><listitem><para><literal>Virtual network</literal>, the recommended type for general guest connectivity on hosts with dynamic / wireless networking configs. Provides a connection whose details are described by the named network definition.</para></listitem>
<listitem><para><literal>Bridge to LAN</literal>, the recommended type for general guest connectivity on hosts with static wired networking configs. Provides a bridge from the guest virtual machine directly onto the LAN. This needs a bridge device on the host with one or more physical NICs.</para></listitem>
<listitem><para><literal>Direct attachment</literal>, the recommended type for high performance or enhanced security.</para></listitem>
</itemizedlist></step>
<step><para>To add a <guilabel>Virtual network</guilabel>, </para>
<itemizedlist><listitem><para>Select the source from the <guimenu>Source</guimenu> list.</para></listitem>
<listitem><para>Select the model from the <guimenu>Model</guimenu> list.</para></listitem>
<listitem><para>If you want to generate the MAC address automatically, in <guimenu>MAC address</guimenu>, select <guimenu>Generate automatically</guimenu>.</para>
<para>If you want to set the MAC address manually, in <guimenu>MAC address</guimenu>, select <guimenu>Set manually</guimenu>, and specify the required MAC address.</para>
</listitem>
</itemizedlist></step>
<step><para>To add <guilabel>Bridge to LAN</guilabel>, </para>
  <itemizedlist>
<listitem><para>Select the model from the <guimenu>Model</guimenu> list.</para></listitem>
<listitem><para>If you want to generate the MAC address automatically, in <guimenu>MAC address</guimenu>, select <guimenu>Generate automatically</guimenu>.</para>
<para>If you want to set the MAC address manually, in <guimenu>MAC address</guimenu>, select <guimenu>Set manually</guimenu>, and specify the required MAC address.</para>
</listitem>
</itemizedlist></step>
      <step><para>To add <guilabel>Direct attachment</guilabel>, select the source from the <guimenu>Source</guimenu> list.</para></step>
      <step><para>Select the <guilabel>Mode</guilabel> as <guimenu>VEPA</guimenu>, <guimenu>Bridge</guimenu>, <guimenu>Private</guimenu>, or <guimenu>Passthrough</guimenu>.</para>
      <para>For more information on mode, see  <link
          xlink:href="https://libvirt.org/formatdomain.html#direct-attachment-to-physical-interface"/></para>
      </step>
      <step><para>Select the model from the <guimenu>Model</guimenu> list.</para></step>

      <step><para>If you want to generate the MAC address automatically, in <guimenu>MAC address</guimenu>, select <guimenu>Generate automatically</guimenu>.</para></step>
      <step><para>If you want to set the MAC address manually, in <guimenu>MAC address</guimenu>, select <guimenu>Set manually</guimenu>, and specify the required MAC address.</para></step>
      <step><para>Click <guilabel>Add</guilabel>.</para>
      <para>The new network interface is added to the virtual machine.</para></step>
    </procedure></section>
  <section><title>Modifying network interfaces</title><procedure>
    <step><para>In the <guimenu>Network interfaces</guimenu> section, click <guimenu>Edit</guimenu> corresponding to the network interface you want to modify.</para></step>
     <step><para>Select the interface type from the drop-down list.</para></step>
      <step><para>Select the source from the <guimenu>Source</guimenu> list.</para></step>
      <step><para>Select the model from the <guimenu>Model</guimenu> list.</para></step>
      <step><para>Modify the <guimenu>MAC address</guimenu>.</para></step>
      <step><para>Click <guilabel>Save</guilabel>.</para></step>
      <step><para>If you want to plug or unplug a network interface, click the <guimenu>Plug</guimenu> or <guimenu>Unplug</guimenu> button corresponding to the network interface.</para></step>
  </procedure></section>
  <section><title>Removing network interfaces</title><procedure>
      <step><para>In the <guimenu>Network interfaces</guimenu> section, click three-dots icon corresponding to the network interface you want to remove.</para></step>
    <step><para>Click <guimenu>Remove</guimenu>.</para>
      <para>The network interface is removed from the virtual machine.</para></step>
    </procedure></section>
</section>
   <section>
    <title>Managing host devices</title>
  <para>You can add host devices to give the VM direct access to physical hardware currently plugged into the host.</para>
  <section><title>Adding host devices</title><procedure>
    <step><para>In the <guilabel>Host devices</guilabel> section, click <guimenu>Add host device</guimenu>.</para></step>
    <step><para>Select the host device type as <guimenu>USB</guimenu> or <guimenu>PCI</guimenu>.</para>
    </step>
    <step><para>Select the required devices to be added from the given list.</para></step>
    <step><para>Click <guimenu>Add</guimenu>.</para>
    <para>The selected host devices are added to the virtual machine.</para></step>
  </procedure></section>
    <section><title>Removing host devices</title>
      <para>In the <guilabel>Host devices</guilabel> section, click <guimenu>Remove</guimenu> corresponding to the host device you want to remove.</para>
      <para>The host device is removed.</para>
      </section>
</section>
    <section>
    <title>Snapshots</title>
  <para></para>
  <section><title>Creating snapshots</title>
    <procedure>
      <step><para>In the <guilabel>Snapshots</guilabel> section, click <guimenu>Create snapshot</guimenu>.</para></step>
      <step><para>Modify the snapshot name if required.</para>
      <para>The default snapshot name is the date and time at which the snapshot was taken.</para></step>
      <step><para>Enter a description for the snapshot.</para></step>
    <step><para>Click <guimenu>Create</guimenu>.</para>
    <para>A snapshot is created with the given name and description.</para>
    </step>
    </procedure></section>
  <section><title>Deleting or reverting snapshots</title>
    <para>You can revert or delete snapshots. Reverting to the snapshot takes the VM back to the time of the snapshot and the current state is lost, along with any data not captured in a snapshot. When you delete a snapshot, the snapshot and all of its captured content is lost.</para>
    <procedure>
    <step><para>To revert a snapshot, click <guimenu>Revert</guimenu> corresponding to the snapshot you want to revert and click <guimenu>Revert</guimenu> to confirm.</para></step>
  <step><para>To delete a snapshot, click <guimenu>Delete</guimenu> corresponding to the snapshot you want to delete and click <guimenu>Delete</guimenu> to confirm.</para></step>
  </procedure></section>
  </section>
 <section>
    <title>Managing shared directories</title>
  <para>Shared host directories must be manually mounted inside the VM. You can mount the shared folder using the command <command>mount -t virtiofs hostshare [mount point]</command> which the <literal>mount point</literal> is the mount point inside the guest.</para>
  <section><title>Adding shared directories</title>
    <procedure>
      <step><para>Add the shared host directories manually,</para>
      <screen>mount -t virtiofs [mount tag] [mount point]</screen>
    <para>In this the <guilabel>mount tag</guilabel> is the tag associated to the exported mount point and <guilabel>mount point</guilabel> is the one inside the guest.</para></step>
    <step><para>In the <guilabel>Shared directories</guilabel> section, click <guimenu>Add shared directory</guimenu>.</para></step>
    <step><para>Select the host path that is to be exported from the <guimenu>Source path</guimenu> drop-down list.</para></step>
    <step><para>Specify the tag name to be used by the guest to mount this export point in <guimenu>Mount tag</guimenu>.</para></step>
    <step><para>If you want to use extended attributes on files and directories, click <guilabel>Show additional options</guilabel> and select the checkbox.</para></step>
    <step><para>Click <guimenu>Share</guimenu>.</para></step>
    </procedure></section>
  <section><title>Removing shared directories</title>
    <procedure>
      <step><para>Click <guimenu>Remove</guimenu> corresponding to the shared directory you want to remove.</para></step>
      <step><para>Click <guimenu>Remove</guimenu>.</para></step>
    </procedure></section>
 </section>
  <section><title>Importing a virtual machine</title>
  <para>
    To import a virtual machine, proceed as follows:
  </para>
  <procedure>
    <step>
      <para>
        Navigate to the <guimenu>Virtual machines</guimenu> page and click <guimenu>Import VM</guimenu>.
      </para>
    </step>
    <step>
      <para>
        In the <guilabel>Details</guilabel> section, specify the following details:</para>
        <itemizedlist>
        <listitem><para>Enter a name for the VM.</para></listitem>
          <listitem><para>Select the <guilabel>Connection</guilabel> as either <guimenu>System</guimenu> or  <guimenu>User session</guimenu>.</para>
          <note><para>Click the information icon next to <guilabel>Connection</guilabel> to view details on the available options.</para></note></listitem>
      <listitem><para>Select the disk image located on the host file system.</para></listitem>
    <listitem><para>Select the appropriate operating system and memory.</para></listitem>
    </itemizedlist>
    </step>
    <step>
      <para>
        Define the <guimenu>Storage parameters</guimenu>, including the storage limit and memory.</para>
    </step>
    <step>
      <para>To run the VM after importing, click <guimenu>Import and run</guimenu>.</para>
    </step>
    <step><para>To edit the VM parameters after importing, click <guimenu>Import and edit</guimenu>.</para>
    <para>Modify the parameters and click <guimenu>Import and run</guimenu>.</para></step>
  </procedure>
  </section>
</topic>
