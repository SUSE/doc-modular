<?xml version="1.0" encoding="UTF-8"?>
<!-- This file originates from the project https://github.com/openSUSE/doc-kit -->
<!-- This file can be edited downstream. -->

<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>


<article xml:id="task-check-cpu-temperature" xml:lang="en"
 role="task"
 xmlns="http://docbook.org/ns/docbook" version="5.1"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">

<title>Working with hardware sensors</title>
  <para>
   To measure the CPU temperature, install and configure the <package>sensors</package> tool that can access and read the hardware sensors.
  </para>
   <procedure>
    <step>
     <para>
     Install the required package:
    </para>
    <screen>&prompt.sudo;<command>zypper install sensors</command></screen>
    </step>
    <step>
     <para>
      To detect all the sensors in the system, run the following command as &rootuser;:
     </para>
     <screen>&prompt.sudo;<command>sensors-detect --auto</command></screen>
     <para>
      The <option>--auto</option> allows checking for all hardware monitoring chips at once
      without probing them one by one. When finished, the script shows a summary of what chips were detected:
     </para>
     <screen>Now follows a summary of the probes I have just done.

Driver `coretemp':
  * Chip `Intel digital thermal sensor' (confidence: 9)

Driver `to-be-written':
  * ISA bus, address 0xa40
    Chip `ITE IT8686E Super IO Sensors' (confidence: 9)

Do you want to generate /etc/sysconfig/lm_sensors? (YES/no):</screen>
    </step>
    <step>
     <para>
      Confirm to generate the file <filename>/etc/sysconfig/lm_sensors</filename>.
      After confirmation, the script creates a &systemd; service
      (<filename>/usr/lib/systemd/system/lm_sensors.service.</filename>) that is enabled by default.
     </para>
    </step>
   </procedure>
  <para>
   Check the status of the &systemd; service:
  </para>
  <screen>&prompt.sudo;<command>systemctl status lm_sensors</command>
● lm_sensors.service - Initialize hardware monitoring sensors
   Loaded: loaded (/usr/lib/systemd/system/lm_sensors.service; enabled; vendor preset: disabled)
   Active: active (exited) since Fri 2021-09-10 16:57:55 CEST; 2min 23s ago
  Process: 32552 ExecStart=/usr/bin/sensors -s (code=exited, status=0/SUCCESS)
  Process: 32551 ExecStart=/sbin/modprobe -qab $BUS_MODULES $HWMON_MODULES (code=exited, status=0/SUCCESS)
 Main PID: 32552 (code=exited, status=0/SUCCESS)
    Tasks: 0
   CGroup: /system.slice/lm_sensors.service

Sep 10 16:57:55 edison systemd[1]: Starting Initialize hardware monitoring sensors...
Sep 10 16:57:55 edison systemd[1]: Started Initialize hardware monitoring sensors.</screen>
   <para>
    After you have completed these steps, your computer has detected all sensors and
    has started to monitor them.
   </para>

<section>
  <title>Getting temperature data</title>
   <para>
    To obtain a snapshot of the current temperature, run the following command:
   </para>
   <screen>&prompt.user;<command>sensors</command>
 [...]
 nvme-pci-0700 <co xml:id="co-nvme-chip"/>
 Adapter: PCI adapter <co xml:id="co-adapter-label"/>
 Composite:    +36.9°C  (low  = -273.1°C, high = +83.8°C)<co xml:id="co-composite"/>
                        (crit = +83.8°C)
 Sensor 1:     +36.9°C  (low  = -273.1°C, high = +65261.8°C)<co xml:id="co-sensor-1"/>
 Sensor 2:     +43.9°C  (low  = -273.1°C, high = +65261.8°C)<co xml:id="co-sensor-2"/><co xml:id="co-anomalous"/>
 
 Adapter: ACPI device
 temp1:        +16.8°C  (crit = +18.8°C)
 temp2:        +27.8°C  (crit = +119.0°C)
 temp3:        +29.8°C  (crit = +119.0°C)
 
 coretemp-isa-0000
 Adapter: ISA adapter
 Package id 0:  +43.0°C  (high = +82.0°C, crit = +100.0°C)
 Core 0:        +41.0°C  (high = +82.0°C, crit = +100.0°C)
 Core 1:        +41.0°C  (high = +82.0°C, crit = +100.0°C)
 Core 2:        +43.0°C  (high = +82.0°C, crit = +100.0°C)
 Core 3:        +41.0°C  (high = +82.0°C, crit = +100.0°C)
 Core 4:        +41.0°C  (high = +82.0°C, crit = +100.0°C)
 Core 5:        +40.0°C  (high = +82.0°C, crit = +100.0°C)</screen>
 <calloutlist>
  <callout arearefs="co-nvme-chip">
    <para>
    Specific hardware component or sensor chip being monitored.
    </para>
  </callout>
  <callout arearefs="co-adapter-label">
    <para>
    Label, the descriptive name for the specific sensor on the chip.
    </para>
  </callout>
  <callout arearefs="co-composite">
    <para>
    Aggregate temperature measurement from several sensors. The <literal>low = -273.1°C, high = +83.8°C</literal>
    means the sensor reading should ideally be within this range. If the temperature
    goes above 83.8 degrees Celsius (crit = +83.8°C), it is deemed critical and may cause hardware issues.
    </para>
  </callout>
  <callout arearefs="co-sensor-1">
    <para>
    This is a stand-alone sensor on the motherboard that is currently reading at 36.9 degrees
    Celsius.
    </para>
  </callout>
  <callout arearefs="co-sensor-2">
    <para>
    This is another stand-alone sensor on the motherboard reading at 43.9 degrees Celsius.
    </para>
  </callout>
  <callout arearefs="co-anomalous">
    <para>
    The value of +65261.8°C is a placeholder or a default maximum value,
    indicating that the sensor is not programmed to measure temperatures above that level.
    Since the actual reading (+36.9°C) is far below this value, we can ignore the anomalously
    high maximum.
    </para>
  </callout>
 </calloutlist>
 <note>
  <title>Output depends on the type of hardware</title>
  <para>The output of the <command>sensors</command> command depends on
    the type of hardware installed on your machine, as different hardware
    components have different sensors.</para>
</note>
</section>
</article>
