<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>

<!-- refers to legacy doc: https://github.com/SUSE/doc-sleha/blob/main/xml/ha_managing_resources.xml -->

<topic xml:id="ha-resources-grouping-with-tags"
 role="task" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Grouping cluster resources with tags</title>
    <meta name="maintainer" content="tahlia.richardson@suse.com" its:translate="no"/>
    <abstract>
      <para>
   Tags are a way to refer to multiple resources at once, without creating any
   colocation or ordering relationship between them. This can be useful for
   grouping conceptually related resources and allows you to stop or start them all with a
   single command. Tags can also be used in constraints.
  </para>
      <para>
        You can create tags with the &crmshell; (&crmsh;) or with &hawk;.
      </para>
    </abstract>
  </info>

  <variablelist role="tabs">
    <varlistentry>
      <term>&crmshell;</term>
      <listitem>
        <para>
          You can perform this procedure on any node in the cluster.
        </para>
        <procedure>
          <step>
            <para>
              Log in either as the &rootuser; user or as a user with <command>sudo</command>
              privileges.
            </para>
          </step>
          <step>
            <para>
              Create a tag and specify the resources to refer to with that tag:
            </para>
<screen>&prompt.user;<command>sudo crm configure tag <replaceable>TAG</replaceable>: <replaceable>RESOURCE1</replaceable> <replaceable>RESOURCE2</replaceable></command></screen>
            <para>
              For example, if you have multiple resources related to a database, you could create
              a tag called <literal>databases</literal> and add all resources related to the
              database to this tag:
            </para>
<screen>&prompt.user;<command>sudo crm configure tag databases: db1 db2 db3</command></screen>
          </step>
          <step>
            <para>
              To view all tags and their resources, run the following command:
            </para>
<screen>&prompt.user;<command>sudo crm configure show type:tag</command></screen>
          </step>
        </procedure>
        <para>
          This allows you to start or stop the resources with a single command:
        </para>
<screen>&prompt.user;<command>sudo crm resource start databases</command>
&prompt.user;<command>sudo crm resource stop databases</command></screen>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>&hawk;</term>
      <listitem>
        <para>
          You can access the &hawk; Web interface from any machine that has network access to
          the nodes.
        </para>
        <procedure>
          <step>
            <para>
              In a Web browser, go to
              <literal>https://<replaceable>HAWKSERVER</replaceable>:7630/</literal>
              and log in.
            </para>
          </step>
          <step>
            <para>
              From the left navigation bar, select <menuchoice><guimenu>Configuration</guimenu>
              <guimenu>Add Resource</guimenu></menuchoice>.
            </para>
          </step>
          <step>
            <para>
              Click <guimenu>Tag</guimenu>.
            </para>
          </step>
          <step>
            <para>
              Enter a unique <guimenu>Tag ID</guimenu>.
            </para>
            </step>
            <step>
            <para>
              From the <guimenu>Objects</guimenu> list, select the resources you want to
              refer to with the tag.
            </para>
            </step>
            <step>
            <para>
              Click <guimenu>Create</guimenu>.
            </para>
            <para>
              A message at the top of the screen shows if the action was successful.
            </para>
          </step>
          <step>
            <para>
              To view all tags and their resources, select <menuchoice><guimenu>Configuration</guimenu>
              <guimenu>Edit Configuration</guimenu></menuchoice> from the left navigation bar, then
              select the <guimenu>Tags</guimenu> tab.
            </para>
          </step>
        </procedure>
        <para>
          This allows you to start or stop the resources with a single operation. From the left navigation bar, select <menuchoice><guimenu>Monitoring</guimenu><guimenu>Status</guimenu></menuchoice>. On this page, all tags have their own tab. From the <guimenu>Operations</guimenu> drop-down list, you can <guimenu>Start</guimenu> or <guimenu>Stop</guimenu> all the resources at once.
        </para>
      </listitem>
    </varlistentry>
  </variablelist>
</topic>
