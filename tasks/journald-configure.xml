<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="journal-configure-journald"
 role="task" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Configuring journald</title><!-- can be changed via merge
in the assembly -->
    <!-- add author's e-mail -->
    <meta name="maintainer" content="shalaka.harne@suse.com" its:translate="no"/>
    <abstract><!-- can be changed via merge in the assembly -->
      <para>
       The topic covers the basic configuration of journald. You can configure the basic behavior of systemd-journald service by modifying <filename>/etc/systemd/journald.conf</filename>. After making the changes, you must restart <filename>systemd-journald</filename>. For more information on file description, see <filename>man 5 journald.conf.</filename>.
       </para>
      </abstract>
  </info>
  <para>
    To configure journald, proceed as follows:
  </para>
  <procedure>
    <step>
      <para>
        To modify the storage type, modify <command>Storage=auto</command>. </para>
          <para>The available options are: </para>
          <itemizedlist>
            <listitem><command>volatile</command>: RAM only (clears on reboot).</listitem>
          <listitem><command>persistent</command>: stored in <filename>/var/log/journal</filename>.</listitem>
        <listitem><command>auto</command>: persistent if directory exists, otherwise volatile.</listitem>
        <listitem><command>none</command>: no logs written to disk or memory.</listitem>
      </itemizedlist>
     <para>If the journal log data is saved to a persistent location, it uses up to 10% of the file system the <filename>/var/log/journal</filename> resides on. For example, if <filename>/var/log/journal</filename> is located on a 30 GB /var partition, the journal may use up to 3 GB of the disk space. To change this limit, change (and uncomment) the <command>SystemMaxUse</command> option: 
       </para><screen>SystemMaxUse=50M
        systemctl restart systemd-journald
      </screen>
     </step>
    <step>
      <para>
        To limit logs rate to prevent flooding logs:
        </para>
        <screen>RateLimitIntervalSec=30s
RateLimitBurst=1000</screen>
    </step>
    <step>
      <para>
        To send the journal to a terminal device to inform you about system messages on a preferred terminal screen, for example <filename>/dev/tty12</filename>:
       </para>
       <screen>ForwardToConsole=yes
TTYPath=/dev/tty12</screen>
      </step>
      <step>
        <para>To forward logs to syslog, modify <command>ForwardToSyslog=yes</command>.Journald is backward compatible with traditional syslog implementations such as rsyslog.</para>
      <itemizedlist>
        <listitem><para>Install rsyslog</para><screen>rpm -q rsyslog</screen></listitem>
        <listitem><para>Enable rsyslog</para><screen>systemctl is-enabled rsyslog</screen></listitem>
        <listitem><para>Enable forwarding to rsyslog in  in <filename>/etc/systemd/journald.conf</filename></para><screen>ForwardToSyslog=yes</screen></listitem>
      </itemizedlist>
      </step>
  </procedure>
</topic>
