<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<topic xml:id="klp-troubleshoot"
 role="concept" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Troubleshooting &klp; issues</title>
    <meta name="maintainer" content="dpopov@suse.com" its:translate="yes"/>
  </info>
  <section xml:id="sec-klp-lifecycle">
    <title>Checking expiration date of the live patch</title>
    <para>
      Make sure that the
      <package>lifecycle-data-sle-module-live-patching</package> is installed,
      then run the <command>zypper lifecycle</command> command. You should see
      expiration dates for live patches in the <literal>Package end of support
      if different from product</literal> section of the output.
    </para>
    <para>
      Every live patch receives updates for one year from the release of the
      underlying kernel package. The
      <link
    xlink:href="https://www.suse.com/products/live-patching/current-patches/">Maintained
      kernels, patch updates and lifecycle</link> page allows you to check
      expiration dates based on the running kernel version without installing
      the product extension.
    </para>
  </section>
  <section xml:id="sec-klp-man-patch-downgrade">
    <title>Manual patch downgrade</title>
    <para>
      If you find the latest live patch problematic, you can downgrade the
      currently installed live patch back to its previous version. We recommend
      performing patch downgrade before the system starts exhibiting issues.
      Keep in mind that a system with kernel warnings or kernel error traces in
      the system log may not be suitable for the patch downgrade procedure. If
      you are unsure whether the system meets the requirements for a patch
      downgrade, contact SUSE Technical Support for help.
    </para>
    <procedure>
      <title>Manual patch downgrade</title>
      <step>
        <para>
          Identify the running live patch using the <command>klp -v
          patches</command> command. You can see the currently running patch on
          the line starting with <literal>RPM:</literal>. For example:
        </para>
<screen>RPM: kernel-livepatch-5_3_18-24_29-default-2-2.1.x86_64</screen>
        <para>
          The <literal>5_3_18-24_29-default</literal> in the example above
          denotes the exact running kernel version.
        </para>
      </step>
      <step>
        <para>
          Use the command <command>zypper search -s
          kernel-livepatch-<replaceable>RUNNING_KERNEL_VERSION</replaceable>-default</command>
          to search for previous versions of the patch. The command returns a
          list of available package versions. Keep in mind that for every new
          live patch package release, the version number increases by one. Make
          sure that you choose the version number one release lower than the
          current one.
        </para>
      </step>
      <step>
        <para>
          Install the desired version with the command <command>zypper in
          --oldpackage
          kernel-livepatch-<replaceable>RUNNING_KERNEL_VERSION</replaceable>-default=<replaceable>DESIRED_VERSION</replaceable></command>.
        </para>
      </step>
    </procedure>
  </section>
</topic>
