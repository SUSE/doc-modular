<?xml version="1.0" encoding="UTF-8"?>
<!-- This file originates from the project https://github.com/openSUSE/doc-kit -->
<!-- This file can be edited downstream. -->
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refer to README.md for file and id naming conventions -->
<topic xml:id="sles-pxe-server-configure-grub2"
 role="task" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Configuring &grub; for PXE boot</title>
    <meta name="maintainer" content="souvik.sarkar@suse.com" its:translate="no"/>
    <abstract>
      <para>
        This section describes how to configure the &grub; bootloader for PXE-based booting on
        &productname; &productnumber;. It includes generating the directory layout, copying
        firmware-specific &grub; binaries and creating a minimal <filename>grub.cfg</filename> to
        launch the &agama; installer.
      </para>
    </abstract>
  </info>
  <section xml:id="sles-pxe-server-configure-grub2-intro">
    <title>Introduction</title>
    <para>
      PXE boot clients retrieve a &grub; binary suited to their firmware (BIOS or UEFI), which then
      loads a configuration file to present boot options. This section shows how to install &grub;
      network boot files and generate a basic &grub; configuration to load the &productname;
      &productnumber; installer kernel and initrd.
    </para>
  </section>
  <section xml:id="sles-pxe-server-configure-grub2-reqs">
    <title>Requirements</title>
    <itemizedlist>
      <listitem>
        <para>
          The &grub; packages for required architectures must already be installed.
        </para>
      </listitem>
      <listitem>
        <para>
          Root writable access to <filename>/srv/tftpboot</filename> or equivalent PXE root.
        </para>
      </listitem>
    </itemizedlist>
  </section>
  <section xml:id="sles-pxe-server-configure-grub2-exec">
    <title>Configuring &grub; for PXE boot</title>
    <para>
      Perform the following steps to prepare the &grub; bootloader for network-based installation.
    </para>
    <procedure>
      <step>
        <para>
          Create the &grub; network boot directory layout under <filename>/srv/tftpboot</filename>.
        </para>
<screen>&prompt.sudo;<command>grub2-mknetdir --net-directory=/srv/tftpboot</command></screen>
      </step>
      <step>
        <para>
          Copy the UEFI bootloader binary to support Secure Boot.
        </para>
<screen>&prompt.sudo;<command>cp /usr/share/efi/x86_64/shim.efi /srv/tftpboot/shim.efi</command></screen>
      </step>
      <step>
        <para>
          Create a minimal &grub; configuration file at <filename>/srv/tftpboot/grub.cfg</filename>
          with the following content:
        </para>
<screen>
menuentry 'Install &productname; &productnumber;' {
  linux /images/SLES16.0/x86_64/liveiso/linux root=live:/images/SLES16.0/x86_64/liveiso/squashfs.img rd.live.dir=liveiso splash=silent
  initrd /images/SLES16.0/x86_64/liveiso/initrd
}
</screen>
      </step>
    </procedure>
  </section>
</topic>
