<?xml version="1.0" encoding="UTF-8"?>
<!-- This file originates from the project https://github.com/openSUSE/doc-kit -->
<!-- This file can be edited downstream. -->
<!DOCTYPE topic
[
  <!ENTITY % entities SYSTEM "../common/generic-entities.ent">
    %entities;
]>
<!-- refers to legacy doc: <add github link to legacy doc piece, if applicable> -->
<!-- point back to this document with a similar comment added to your legacy doc piece -->
<!-- refer to README.md for file and id naming conventions -->
<!-- metadata is dealt with on the assembly level -->
<topic xml:id="virt-components-installing"
 role="task" xml:lang="en"
 xmlns="http://docbook.org/ns/docbook" version="5.2"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink"
 xmlns:trans="http://docbook.org/ns/transclusion">
  <info>
    <title>Installing virtualization components</title>
    <meta name="maintainer" content="tbazant@suse.com" its:translate="no"/>
    <abstract>
      <para>
        In order to run a virtualization server (&vmhost;) that can host
        multiple guest systems (&vmguest;s), you need to install required
        virtualization components on the server. These components vary depending
        on which virtualization technology you want to use.
      </para>
    </abstract>
  </info>
  <para>
    You can install the virtualization tools required to run a &vmhost; in one
    of the following ways:
  </para>
  <itemizedlist>
    <listitem>
      <para>
        By selecting a specific system role during &productname; installation on
        the &vmhost;
      </para>
    </listitem>
    <listitem>
      <para>
        By running the <emphasis>&yast; Virtualization</emphasis> module on an
        already installed and running &productname;.
      </para>
    </listitem>
    <listitem>
      <para>
        By installing specific installation patterns on an already installed and
        running &productname;.
      </para>
    </listitem>
  </itemizedlist>
  <procedure>
    <title>Specifying a system role</title>
    <step>
      <para>
        Start &productnameshort; installation and follow the instructions until
        you reach the <guimenu>System Role</guimenu> screen.
      </para>
      <figure>
        <title>System Role screen</title>
        <mediaobject>
          <imageobject role="fo">
            <imagedata fileref="virt-system-roles.png" width="75%"/>
          </imageobject>
          <imageobject role="html">
            <imagedata fileref="virt-system-roles.png" width="75%"/>
          </imageobject>
          <textobject role="description"><phrase>System Role screen</phrase>
          </textobject>
        </mediaobject>
      </figure>
    </step>
    <step>
      <para>
        On the <guimenu>System Role</guimenu> screen, select either the
        <guimenu>KVM Virtualization Host</guimenu> or the <guimenu>Xen
        Virtualization Host</guimenu> role. The appropriate software selection
        and setup will be automatically performed during the &productname;
        installation.
      </para>
      <important>
        <para>
          Both virtualization system roles will create a dedicated
          <filename>/var/lib/libvirt</filename> partition, and enable the
          &firewalld; and &kdump; services.
        </para>
      </important>
    </step>
  </procedure>
  <procedure>
    <title>Running the &yast; virtualization module</title>
    <para>
      To install virtualization components on an already installed system, use
      the <emphasis>&yast; Virtualization</emphasis> module.
    </para>
    <tip>
      <para>
        The <emphasis>&yast; Virtualization</emphasis> module is included in the
        <package>yast2-vm</package> package. Verify it is installed on the
        &vmhost; before installing virtualization components.
      </para>
    </tip>
    <step>
      <para>
        Start &yast; and select <menuchoice><guimenu>Virtualization</guimenu>
        <guimenu>Install Hypervisor and Tools</guimenu></menuchoice>.
      </para>
    </step>
    <step>
      <para>
        Depending on your required solution, select <guimenu>&kvm;
        server</guimenu> for a minimal installation of &qemu; and &kvm;
        environment. Select <guimenu>&kvm; tools</guimenu> if you want to use
        the &libvirt;-based management stack as well. Confirm with
        <guimenu>Accept</guimenu>.
      </para>
    </step>
    <step>
      <para>
        &yast; offers to automatically configure a network bridge on the
        &vmhost;. It ensures proper networking capabilities of the &vmguest;.
        Agree to do so by selecting <guimenu>Yes</guimenu>, otherwise choose
        <guimenu>No</guimenu>.
      </para>
    </step>
    <step>
      <para>
        After the setup has been finished, you can start creating and
        configuring &vmguest;s. Rebooting the &vmhost; is not required.
      </para>
    </step>
  </procedure>
  <procedure>
    <title>Installing the &xen; environment</title>
    <para>
      To install the &xen; virtualization environment, proceed as follows:
    </para>
    <step>
      <para>
        Start &yast; and select<menuchoice> <guimenu>Virtualization</guimenu>
        <guimenu>Install Hypervisor and Tools</guimenu></menuchoice>.
      </para>
    </step>
    <step>
      <para>
        Select <guimenu>&xen; server</guimenu> for a minimal installation of
        &xen; environment. Select <guimenu>&xen; tools</guimenu> if you want to
        use the &libvirt;-based management stack as well. Confirm with
        <guimenu>Accept</guimenu>.
      </para>
    </step>
    <step>
      <para>
        &yast; offers to automatically configure a network bridge on the
        &vmhost;. It ensures proper networking capabilities of the &vmguest;.
        Agree to do so by selecting <guimenu>Yes</guimenu>, otherwise choose
        <guimenu>No</guimenu>.
      </para>
    </step>
    <step>
      <para>
        After the setup has been finished, you need to reboot the machine with
        the <emphasis>&xen; kernel</emphasis>.
      </para>
      <tip>
        <title>Default boot kernel</title>
        <para>
          If everything works as expected, change the default boot kernel with
          &yast; and make the &xen;-enabled kernel the default. For more
          information about changing the default kernel, see FIXME
          <literal>sec-grub2-yast2-config</literal>.
        </para>
      </tip>
    </step>
  </procedure>
</topic>
