<?xml version="1.0" encoding="UTF-8"?>
<!-- This file originates from the project https://github.com/openSUSE/doc-kit -->
<!-- This file can be edited downstream. -->
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>
<article xml:id="concept-transactional-update" xml:lang="en"
 role="concept"
 xmlns="http://docbook.org/ns/docbook" version="5.1"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">
 <info>
  <title>Basic concept of transactional updates</title>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker>
    <dm:url>https://bugzilla.suse.com/enter_bug.cgi</dm:url>
    <dm:component>Smart Docs</dm:component>
    <dm:product>Documentation</dm:product>
    <dm:assignee>tbazant@suse.com</dm:assignee>
   </dm:bugtracker>
   <dm:translation>no</dm:translation>
  </dm:docmanager>
 </info>
 <section xml:id="what-is-transactional-update">
  <title>What are transactional updates?</title>
  <para>
   The &alp; (&alpshort;) was designed to use a read-only root file system.
   This means that after the deployment is complete, you are not able to
   perform direct modifications to the root file system, for example, by using
   the <command>zypper</command> command. Instead, &alpshort; introduces the
   concept of transactional updates which enables you to modify your system and
   keep it up to date.
  </para>
 </section>
 <section xml:id="how-it-works-transactional-update">
  <title>How do transactional updates work?</title>
  <para>
   Each time you call the &tr-up; command to change your system&mdash;either to
   install a package, perform an update or apply a patch&mdash;the following
   actions take place:
  </para>
  <procedure>
   <title>Modifying the root file system</title>
   <step>
    <para>
     A new read-write snapshot is created from your current root file system,
     or from a snapshot that you specified.
    </para>
   </step>
   <step>
    <para>
     All changes are applied (updates, patches or package installation).
    </para>
   </step>
   <step>
    <para>
     The snapshot is switched back to read-only mode.
    </para>
   </step>
   <step>
    <para>
     The new root file system snapshot is prepared, so that it will be active
     after you reboot.
    </para>
   </step>
   <step>
    <para>
     After rebooting, the new root file system is set as the default snapshot.
    </para>
    <note>
     <para>
      Bear in mind that without rebooting your system, the changes will not be
      applied.
     </para>
    </note>
   </step>
  </procedure>
  <warning>
   <para>
    If you do not reboot your machine before performing further changes,
    the &tr-up; command will create a new snapshot from the current root file
    system. This means that you will end up with several parallel snapshots,
    each including that particular change but not changes from the other
    invocations of the command. After reboot, the most recently created
    snapshot will be used as your new root file system, and it will not include
    changes done in the previous snapshots.
   </para>
  </warning>
 </section>
 <section xml:id="how-it-works-transactional-update-repositories">
  <title>Software repositories</title>
  <para>
   The current &alpshort; image points to the following two software
   repositories:
  </para>
  <variablelist>
   <varlistentry>
    <term>ALP</term>
    <listitem>
     <para>
      <literal>https://download.opensuse.org/repositories/SUSE:/ALP:/PUBLISH/images/repo/ALP-0.1-x86_64-Media1/</literal>
     </para>
     <para>
      This repository is enabled. It is a subset of the build repository and an
      equivalent of the <literal>POOL</literal> repository known from other
      &suse; software products. It will remain unchanged until the release of
      the next &alpshort; prototype.
     </para>
     <tip>
      <para>
       If you need a package which is not included in the
       <literal>ALP</literal> repository, you may find it in the
       <literal>ALP-Build</literal> repository. To enable it, run:
      </para>
<screen>&prompt.root;zypper mr -e ALP-Build</screen>
     </tip>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>ALP-Build</term>
    <listitem>
     <para>
      <literal>https://download.opensuse.org/repositories/SUSE:/ALP/standard/</literal>
     </para>
     <para>
      This repository is disabled by default. It is used for building the
      project. It includes all packages built in the
      <literal>SUSE:ALP</literal> project in the build service and will be
      moving forward over the time with future development.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </section>
 <section xml:id="benefits-transactional-update">
  <title>Benefits of transactional updates</title>
  <itemizedlist>
   <listitem>
    <para>
     They are atomic&mdash;the update is applied only if it completes
     successfully.
    </para>
   </listitem>
   <listitem>
    <para>
     Changes are applied in a separate snapshot and so do not influence the
     running system.
    </para>
   </listitem>
   <listitem>
    <para>
     Changes can easily be rolled back.
    </para>
   </listitem>
  </itemizedlist>
 </section>
 <section xml:id="related-transactional-update">
  <title>Related topics</title>
  <itemizedlist>
   <listitem>
    <para>
     Usage of the &tr-up; command is detailed in <xref
     linkend="reference-transactional-update-usage"/>.
    </para>
   </listitem>
  </itemizedlist>
 </section>
</article>
