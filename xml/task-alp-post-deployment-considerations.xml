<?xml version="1.0" encoding="UTF-8"?>
<!-- This file originates from the project https://github.com/openSUSE/doc-kit -->
<!-- This file can be edited downstream. -->
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>
<article xml:id="task-post-deployment-considerations" xml:lang="en"
 role="task"
 xmlns="http://docbook.org/ns/docbook" version="5.1"
 xmlns:its="http://www.w3.org/2005/11/its"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>Post-deployment considerations</title>
  <section xml:id="introduction-post-deployment-considerations">
    <title>Introduction</title>
    <para>
      This article includes important information and tasks that you need to
      consider after you successfully deploy the &alp; (&alpshort;).
    </para>
  </section>
  <section xml:id="alp-post-deploy-full-disk-encryption">
    <title>Full disk encryption</title>
    <section xml:id="alp-post-deploy-full-disk-encryption-password">
      <title>Change encryption password</title>
      <para>
        During the &alpshort; deployment, you entered a password that is used
        for disk encryption. If you want to change the password, run the
        following command:
      </para>
<screen>&prompt.root;fdectl passwd</screen>
    </section>
    <section xml:id="alp-post-deploy-full-disk-encryption-tpm">
      <title>TPM device</title>
      <para>
        Without a TPM chip, you need to enter the encryption password to
        decrypt the disk on each &alpshort; boot. On systems that have a TPM
        2.0 chip, &alpshort; deployed with &dinstaller; supports the automatic
        protection of the LUKS volume with a TPM device. The requirement is
        that the machine must use the &uefisecboot; enabled.
      </para>
      <para>
        If the &dinstaller; detects a TPM 2.0 chip and &uefisecboot;, it will
        create a secondary LUKS key. On the first boot, &alpshort; will use the
        TPM to protect this key and configure the &grub; boot loader to
        automatically unwrap the key. Be aware that you must remove the ISO
        after the installer has finished and before the system boots for the
        first time. This is because we use the TPM to ensure that the system
        comes up with exactly the same configuration before unlocking the LUKS
        partition.
      </para>
      <para>
        This allows you to use the full disk encryption without having to type
        the disk password on each reboot. However, the disk password is still
        there and can be used for recovery. For example, after updating the
        &grub; boot loader, or the SHIM loader, the TPM will no longer be able
        to unseal the secondary key correctly, and &grub; will have to fall
        back to the password.
      </para>
    </section>
  </section>
  <section xml:id="alp-post-deploy-selinux">
    <title>&selnx;</title>
    <para>
      Security-Enhanced Linux (&selnx;) is a security framework that increases
      system security by defining access controls for applications, processes,
      and file on the file system.
    </para>
    <para>
      &alpshort; ships with &selnx; enabled and set to the restricting
      <emphasis>enforce</emphasis> mode for increased security. The enforce
      mode can lead to processes or workloads not behaving correctly because
      the default policy may be too strict. If you observe such unexpected
      issues, set &selnx; to the <emphasis>permissive</emphasis> mode that does
      not enforce &selnx; policies but still gathers offences against them
      called <emphasis>Access Vector Rules</emphasis> (AVCs).
    </para>
    <para>
      To set &selnx; into the permissive mode, run:
    </para>
<screen>&prompt.root;setenforce 0</screen>
    <para>
      To monitor AVCs, look for log messages in the Audit log and &systemd;
      journal, for example:
    </para>
<screen>&prompt.root;tail -f /var/log/audit/audit.log | grep -i AVC</screen>
    <para>
      and
    </para>
<screen>&prompt.root;journalctl -f | grep -i AVC</screen>
    <para>
      If such messages appear while using the application that did not behave
      correctly when &selnx; was set to the enforce mode, the policies are
      probably too restrictive and need updating. You can help to fine-tune
      &selnx; policies by creating a bug report at
      <link xlink:href="https://bugzilla.suse.com/enter_bug.cgi?classification=SUSE%20ALP%20-%20SUSE%20Adaptable%20Linux%20Platform"/>.
      Specify <literal>Basesystem</literal> as a component and attach gathered
      unique lines that include AVCs.
    </para>
  </section>
  <section xml:id="related-post-deployment-considerations">
    <title>Related topics</title>
    <itemizedlist>
      <listitem>
        <para>
          &alpshort; deployment is described in
          <xref linkend="concept-alp-deployment"/>.
        </para>
      </listitem>
      <listitem>
        <para>
          Installing software packages and patterns is detailed in
          <link xlink:href="https://documentation.suse.com/sles/html/SLES-all/cha-sw-cl.html"/>.
        </para>
      </listitem>
      <listitem>
       <para>
        The &selnx; framework is detailed in <link
        xlink:href="https://documentation.suse.com/sles/html/SLES-all/cha-selinux.html"/>.
       </para>
      </listitem>
    </itemizedlist>
  </section>
</article>
